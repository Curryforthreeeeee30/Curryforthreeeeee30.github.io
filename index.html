<!DOCTYPE html>
<html lang="zh-CN">
<head>

  

  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="baidu-site-verification" content="m5NcKgUu0g" />

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wyqian.top","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","width":320,"display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Do not talk, show me your code!">
<meta property="og:type" content="website">
<meta property="og:title" content="SC&amp;KD&#39;s Blog">
<meta property="og:url" content="http://wyqian.top/index.html">
<meta property="og:site_name" content="SC&amp;KD&#39;s Blog">
<meta property="og:description" content="Do not talk, show me your code!">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="精进的coder">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://wyqian.top/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>SC&KD's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">SC&KD's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">小Q写字的地方</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-allergies fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-battery-full fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/Curryforthreeeeee30" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://wyqian.top/2021/05/14/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%BA%8C%EF%BC%89/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%BA%8C%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="精进的coder">
      <meta itemprop="description" content="Do not talk, show me your code!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SC&KD's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/14/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%BA%8C%EF%BC%89/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%BA%8C%EF%BC%89/" class="post-title-link" itemprop="url">单体电商项目架构，开发与上线（二）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-05-14 10:49:57" itemprop="dateCreated datePublished" datetime="2021-05-14T10:49:57+08:00">2021-05-14</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/05/14/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%BA%8C%EF%BC%89/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%BA%8C%EF%BC%89/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/05/14/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%BA%8C%EF%BC%89/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%BA%8C%EF%BC%89/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>200</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="实现电商首页轮播图功能"><a href="#实现电商首页轮播图功能" class="headerlink" title="实现电商首页轮播图功能"></a>实现电商首页轮播图功能</h3><p>首先来看轮播图的数据库表：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-14_105732.png" alt></p>
<p>关于这张表有几点说明：</p>
<p>1、背景色：这是为了配合轮播的图片显示，网页两边的背景色需要和图片的颜色保持一致。</p>
<p>2、商品id：用户点击轮播图中的某一张图的时候，会跳转到相应的商品详情页面，对应商品id。</p>
<p>3、商品分类id：用户点击了商品分类之后，显示的就是商品分类id下的所有商品。</p>
<p>4、轮播图类型：用于判断，可以根据商品id或者分类进行页面跳转，1：商品 2：分类</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
    
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://wyqian.top/2021/05/08/RequestBody%E8%AF%A6%E8%A7%A3/RequestBody%E8%AF%A6%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="精进的coder">
      <meta itemprop="description" content="Do not talk, show me your code!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SC&KD's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/08/RequestBody%E8%AF%A6%E8%A7%A3/RequestBody%E8%AF%A6%E8%A7%A3/" class="post-title-link" itemprop="url">@RequestBody详解</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-05-08 09:33:38" itemprop="dateCreated datePublished" datetime="2021-05-08T09:33:38+08:00">2021-05-08</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/05/08/RequestBody%E8%AF%A6%E8%A7%A3/RequestBody%E8%AF%A6%E8%A7%A3/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/05/08/RequestBody%E8%AF%A6%E8%A7%A3/RequestBody%E8%AF%A6%E8%A7%A3/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.3k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="RequestBody介绍"><a href="#RequestBody介绍" class="headerlink" title="@RequestBody介绍"></a>@RequestBody介绍</h3><p>​    1、@RequestBody主要<strong><em>用来接收前端传递给后端的json字符串中的数据</em></strong>的（请求体中的数据）。由于<strong><em>GET方式没有请求体</em></strong>，所以使用@RequestBody接受数据的时候，前端不能用GET方式提交数据，而是用<strong><em>POST方式</em></strong>提交。</p>
<p>​    2、在后端的同一个接口中，@RequestBody和@ResquestParam()可以同时使用，@RequestBody最多只能有一个，而@ResquestParam()可以有多个。</p>
<p>​    3、@RequestBody 接收的是<strong><em>请求体</em></strong>里面的数据；而@RequestParam接收的是<strong><em>key-value</em></strong>里面的参数。</p>
<p>​    4、如果参数前写了@RequestParam(xxx)，那么前端必须有对应的xxx名字才行(不管其是否有值，当然可以通过设置该注解的required属性来调节是否必须传)，如果没有xxx名的话，那么请求会出错，报400。</p>
<p>​    5、如果参数前不写@RequestParam(xxx)的话，那么就前端可以有可以没有对应的xxx名字才行，如果有xxx名的话，那么就会自动匹配；没有的话，请求也能正确发送。</p>
<p>如果后端参数是一个对象，且该参数前是以@RequestBody修饰的，那么前端传递json参数时，必须满足以下要求：</p>
<ul>
<li>后端@RequestBody注解对应的类在将HTTP的输入流(含请求体)装配到目标类(即：@RequestBody后面的类)时，会根据json字符串中的key来匹配对应实体类的属性。</li>
<li>json字符串中，如果value为””的话，后端对应的属性如果是String类型的，那么接收到的就是””;如果后端属性是Integer、Double类型的话，后端接收到的就是null。</li>
<li>json字符串中，如果value为null的话，后端对应收到的就是null。</li>
</ul>
<p>测试：</p>
<p>准备工作：</p>
<p>1、新建一个SpringBoot项目</p>
<p>2、写一个pojo类：User</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-08_101428.png" alt></p>
<p>由于这里无需进行数据库操作，所以直接写接口：</p>
<p>1、@RequestBody直接用<strong><em>String</em></strong>去接收前端传过来的json数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-08_101531.png" alt></p>
<p>测试：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-08_101327.png" alt></p>
<p>2、@RequestBody以<strong><em>简单对象</em></strong>接收前端传过来的json数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-08_101940.png" alt></p>
<p>测试：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-08_101918.png" alt></p>
<p>3、@RequestBody以<strong><em>复杂对象</em></strong>接收前端传过来的json数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/20180709160616858.png" alt></p>
<p>4、@RequestBody和@RequestParam()同时使用：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-08_103035.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-08_103001.png" alt></p>
<p>5、@RequestBody接收请求体中的json数据；不加注解接收URL中的数据并组装为对象，不加注解就相当于是@RequestParam。</p>
<p>但是如果是@RequestParam(“token”)，那么前端一定要有对应的字段才行，否则会报错！</p>
<p>测试：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-08_103902.png" alt></p>
<p>没带token，请求之后报错！</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-08_103810.png" alt></p>
<p>总结：</p>
<p>​    后端@RequestBody注解对应的类在将HTTP的输入流(含请求体)装配到目标类(即:@RequestBody后面的类)时，会根据json字符串中的key来匹配对应实体类的属性，如果匹配一致且json中的该key对应的值 符合(或可转换为)实体类的对应属性的类型要求时，会调用实体类的setter方法将值赋给该属性。</p>
<p>@RequestParam:</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-08_105907.png" alt></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
    
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://wyqian.top/2021/05/06/%E6%9E%9A%E4%B8%BE%E7%B1%BB%E8%AE%B2%E8%A7%A3/%E6%9E%9A%E4%B8%BE%E7%B1%BB%E8%AE%B2%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="精进的coder">
      <meta itemprop="description" content="Do not talk, show me your code!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SC&KD's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/06/%E6%9E%9A%E4%B8%BE%E7%B1%BB%E8%AE%B2%E8%A7%A3/%E6%9E%9A%E4%B8%BE%E7%B1%BB%E8%AE%B2%E8%A7%A3/" class="post-title-link" itemprop="url">枚举类讲解</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-05-06 15:16:59" itemprop="dateCreated datePublished" datetime="2021-05-06T15:16:59+08:00">2021-05-06</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/05/06/%E6%9E%9A%E4%B8%BE%E7%B1%BB%E8%AE%B2%E8%A7%A3/%E6%9E%9A%E4%B8%BE%E7%B1%BB%E8%AE%B2%E8%A7%A3/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/05/06/%E6%9E%9A%E4%B8%BE%E7%B1%BB%E8%AE%B2%E8%A7%A3/%E6%9E%9A%E4%B8%BE%E7%B1%BB%E8%AE%B2%E8%A7%A3/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>632</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="枚举类初探"><a href="#枚举类初探" class="headerlink" title="枚举类初探"></a>枚举类初探</h3><p>百度百科：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_151846.png" alt></p>
<p>一个简单的枚举类：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_151943.png" alt></p>
<p>输出结果：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_152021.png" alt></p>
<h3 id="枚举类产生之前"><a href="#枚举类产生之前" class="headerlink" title="枚举类产生之前"></a>枚举类产生之前</h3><p>在不使用枚举类之前，我们对“春夏秋冬”四个值分别赋一个值的话，通常会这样写：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_152200.png" alt></p>
<p>上述方法定义十分繁琐，而且容易出错。例如我们定义的int数字出现重复，编译器也不会给出任何的警示。同时，这样的操作是实在太频繁了，最终Java 5中增加了枚举类型。</p>
<p>而是用枚举类型后，一切就变成了如下所示的简单几行：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_152417.png" alt></p>
<p>java自动给按照枚举类出现的顺序，从0开始分配了编号，通过<strong><em>name()</em></strong>可以获得枚举值的名称，通过<strong><em>ordinal()</em></strong>可以获得枚举值的编号。</p>
<h3 id="枚举实现原理"><a href="#枚举实现原理" class="headerlink" title="枚举实现原理"></a>枚举实现原理</h3><p>我们在定义枚举类的时候并没有定义name()和ordinal()方法。点击name()，发现进入了一个抽象类：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_152703.png" alt></p>
<p>我们的Season类就是继承了这样的一个抽象类：Enum</p>
<p>我们对Season类进行反编译：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_161029.png" alt></p>
<p>可以看到：</p>
<ol>
<li>枚举类反编译之后生成了一个扩展了java.lang.Enum的类</li>
<li>枚举类是final的，因此我们无法再继承了</li>
<li>我们定义的每个枚举值都是该类的一个成员，且成员类型仍然是Season类型。</li>
<li>枚举类中被默认增加了许多的静态方法，例如：values()。</li>
</ol>
<p><strong><em>编译器帮助我们生成每个枚举值的对象!</em></strong></p>
<p>我们在总结一下，我们使用enum定义的枚举类型，会在编译之后转化为一个继承了java.lang.Enum的类，而我们定义的每个枚举值都会在类的初始化阶段被实例化为我们所定义的枚举类的一个对象。</p>
<p>同时，编译器还帮我们在类中增加了两个方法，分别是：values()和valueOf()。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
    
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://wyqian.top/2021/04/27/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%B8%80%EF%BC%89/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%B8%80%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="精进的coder">
      <meta itemprop="description" content="Do not talk, show me your code!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SC&KD's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/27/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%B8%80%EF%BC%89/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%B8%80%EF%BC%89/" class="post-title-link" itemprop="url">单体电商项目架构，开发与上线（一）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-27 19:26:42" itemprop="dateCreated datePublished" datetime="2021-04-27T19:26:42+08:00">2021-04-27</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/04/27/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%B8%80%EF%BC%89/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%B8%80%EF%BC%89/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/04/27/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%B8%80%EF%BC%89/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%B8%80%EF%BC%89/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>28k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>26 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <a id="more"></a>

<h3 id="大型网站架构演进历程"><a href="#大型网站架构演进历程" class="headerlink" title="大型网站架构演进历程"></a>大型网站架构演进历程</h3><p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_142151.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_142234.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_142725.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_142813.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_142851.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_143022.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_143045.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_143106.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_143143.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_143213.png" alt></p>
<h3 id="架构师所需具备的技术栈与能力"><a href="#架构师所需具备的技术栈与能力" class="headerlink" title="架构师所需具备的技术栈与能力"></a>架构师所需具备的技术栈与能力</h3><p>技术栈：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_143420.png" alt></p>
<p>能力：</p>
<ul>
<li>技术全面，有广度</li>
<li>关注前沿技术</li>
<li>全局观、预判</li>
<li>把控团队，忙而不乱</li>
<li>系统分解与模块拆分</li>
<li>指导与培训</li>
<li>沟通与协调能力</li>
<li>抽象、举例、画图</li>
<li>软技能</li>
</ul>
<h3 id="前后端技术选型"><a href="#前后端技术选型" class="headerlink" title="前后端技术选型"></a>前后端技术选型</h3><p><strong>后端技术选型</strong>  SpringBoot   VS    SpringMVC</p>
<ul>
<li>SpringMVC是框架，是Spring的子集，是Spring的一个模块</li>
<li>SpringBoot是工具（配置工具、整合工具）</li>
<li>从繁琐配置（xml）到零配置（yml）</li>
<li>SpringBoot集成了多样化中间件【*-starter】,一定程度上简化了maven的配置</li>
<li>从外置tomcat变为内置tomcat</li>
</ul>
<p>聊一聊Struts</p>
<ul>
<li>安全漏洞，对于技术选型来讲的话，安全性是一定需要考虑的问题。</li>
<li>请求变量共享，当用户请求变多的话，由于Action的线程安全问题，导致Action的一些变量可能会出现共享的情况。</li>
<li>Filter拦截。SpringMVC、SpringBoot是通过AOP实现的，但是Struts是通过类拦截</li>
<li>非Spring官方自产自销，当Struts与Spring结合的时候，会略显得有点重。</li>
</ul>
<p><strong>前端技术选型</strong></p>
<ul>
<li>MVVM开发模式，去DOM，不是通过DOM去操作结点</li>
<li>Jquery、Vue.js（渐进式框架）</li>
<li>html</li>
<li>css</li>
</ul>
<p>技术选型所要考虑的</p>
<ul>
<li>切合业务</li>
<li>社区活跃度</li>
<li>团队技术水平</li>
<li>版本更新迭代周期（例如Dubbo停更了一段时间）</li>
<li>试错精神</li>
<li>安全性</li>
<li>开源精神</li>
</ul>
<h3 id="前后端分离开发模式"><a href="#前后端分离开发模式" class="headerlink" title="前后端分离开发模式"></a>前后端分离开发模式</h3><p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_151253.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_151626.png" alt></p>
<h3 id="项目分层设计原则"><a href="#项目分层设计原则" class="headerlink" title="项目分层设计原则"></a>项目分层设计原则</h3><p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_152033.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_152329.png" alt></p>
<h3 id="构建聚合工程"><a href="#构建聚合工程" class="headerlink" title="构建聚合工程"></a>构建聚合工程</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>packaging默认是jar类型，pom、jar、war区别：</p>
<p><a href="https://blog.csdn.net/imaginehero/article/details/103706732" target="_blank" rel="noopener">https://blog.csdn.net/imaginehero/article/details/103706732</a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        1、聚合工程里可以分为顶级项目（顶级工程、父工程）与子工程，这两者的关系其实就是父子继承的关系</span></span><br><span class="line"><span class="comment">        子工程在maven里称之为模块（module），模块之间是平级的，是可以相互依赖的。</span></span><br><span class="line"><span class="comment">        2、子模块可以使用顶级工程里所有的资源（依赖），子模块之间如果要使用资源，必须构建依赖（构建关系，把pom坐标拿过来）</span></span><br><span class="line"><span class="comment">        3、一个顶级工程是可以由多个不同的子工程共同组合而成。</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure>

<p>foodie-dev-common   pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>foodie-dev-common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>foodie-dev-pojo   pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--在pojo中引入common的依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.wyqian<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>foodie-dev-common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>foodie-dev-mapper pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            mapper-&gt;pojo-&gt;common</span></span><br><span class="line"><span class="comment">            mapper通过pojo是可以使用common中相应的方法的</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.wyqian<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>foodie-dev-pojo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>foodie-dev-service pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            service -&gt; mapper -&gt; pojo -&gt; common</span></span><br><span class="line"><span class="comment">            service是可以使用pojo和common中相应的方法的</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.wyqian<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>foodie-dev-mapper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>foodie-dev-api  pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            common-mail</span></span><br><span class="line"><span class="comment">            api -&gt; service -&gt; mapper -&gt; pojo -&gt; common</span></span><br><span class="line"><span class="comment">            api -&gt; common-mail</span></span><br><span class="line"><span class="comment">            api是可以使用service、pojo和common中相应的方法的</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.wyqian<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>foodie-dev-service<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在引入每一个子模块的时候，需要看一下顶级工程里面<modules></modules>里面是不是添加进去了这个子模块，在引入上述这么多子模块之后，顶级工程中 pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span>&gt;</span>foodie-dev-common<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span>&gt;</span>foodie-dev-pojo<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span>&gt;</span>foodie-dev-mapper<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span>&gt;</span>foodie-dev-service<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span>&gt;</span>foodie-dev-api<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在引入子模块完成之后，需要安装一下，建立各个模块之间的依赖关系。</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_162955.png" alt></p>
<h3 id="PDMan数据库建模工具的使用"><a href="#PDMan数据库建模工具的使用" class="headerlink" title="PDMan数据库建模工具的使用"></a>PDMan数据库建模工具的使用</h3><p>我们在真实的业务开发的时候，不会直接在数据库管理工具中创建表，PDMan提供了这样的一个功能，并且出去展示的时候，不可能直接将数据库展示给用户看，PDMan这样的数据库建模工具就显得比较专业。</p>
<p>PDMan下载官网：<a href="http://pdman.cn/#/，无脑安装即可。" target="_blank" rel="noopener">http://pdman.cn/#/，无脑安装即可。</a></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_170847.png" alt></p>
<p>连接自己的数据库</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_171338.png" alt></p>
<p>同步数据库</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_171516.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_171755.png" alt></p>
<h3 id="生产环境增量与全量脚本迭代"><a href="#生产环境增量与全量脚本迭代" class="headerlink" title="生产环境增量与全量脚本迭代"></a>生产环境增量与全量脚本迭代</h3><p>重建数据库：新建一张临时表，将当前数据复制到临时表中，然后删除旧表并新建表（把新的字段加上），将数据复制过去！</p>
<p>字段增量：修改原数据库字段。</p>
<p>生产环境中应选择<strong>字段增量</strong>！</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_201049.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-28_200716.png" alt></p>
<h3 id="数据库物理外键移除原因"><a href="#数据库物理外键移除原因" class="headerlink" title="数据库物理外键移除原因"></a>数据库物理外键移除原因</h3><p>加外键的好处：1、数据库的完整性；2、强调了数据的强一致性</p>
<p>数据库外键：</p>
<ul>
<li>性能影响。在大并发的情况下，物理外键一定会影响数据库的性能。</li>
<li>热更新。热更新就是指不停机进行更新。外键会导致新更新上去的一些代码无法运行，因为需要去匹配现有的一些外键！这时候就需要去重启服务器！</li>
<li>降低耦合度。删除物理外键，用逻辑外键代替！</li>
<li>数据库分库分表。有外键的话，难以实现分库分表。</li>
</ul>
<p>总结：在设计一个传统的小型项目的时候，物理外键可以存在，但是在设计一个大型互联网项目的时候是绝对不能存在物理外键的！</p>
<h3 id="聚合工程整合SpringBoot"><a href="#聚合工程整合SpringBoot" class="headerlink" title="聚合工程整合SpringBoot"></a>聚合工程整合SpringBoot</h3><p>在父项目的pom中引入下面的依赖。使之变成SpringBoot项目，spring-boot-starter-parent中管理了我们很多需要的依赖。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后添加编码相关的配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.reporting.outputEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后从parent中取得下面的依赖，可以看到在parent中已经管理好了版本，这里就不需要加版本信息。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                排除spring-boot-starter-logging的jar包，因为后续我们会引入其他的日志工具！</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            springboot默认会解析yml文件，加上这个依赖，就可以解析别的配置文件！</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>让项目跑起来：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-29_193432.png" alt></p>
<p>在Controller中写一个HelloController类测试一下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello World~"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试成功页面：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-29_193540.png" alt></p>
<h3 id="SpringBoot自动装配简述"><a href="#SpringBoot自动装配简述" class="headerlink" title="SpringBoot自动装配简述"></a>SpringBoot自动装配简述</h3><p>点开主启动类下面的run方法：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-29_193908.png" alt></p>
<p>点开@SpringBootApplication注解：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-29_194500.png" alt></p>
<p>点开@SpringBootConfiguration注解：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-29_194911.png" alt></p>
<p><strong><em>SpringBoot怎么实现自动装配的？</em></strong>—-&gt;spring.factories</p>
<p>点开@EnableAutoConfiguration–&gt;AutoConfigurationImportSelector</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-29_200224.png" alt></p>
<p>比如说在SpringBoot中内置的Tomcat是怎么启动的？</p>
<p>打开spring.factories，有一个类叫做EmbeddedWebServerFactoryCustomizerAutoConfiguration，打开：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-29_200617.png" alt></p>
<p>点开Tomcat类，可以发现里面有Tomcat所有的操作！这里相当于是配置Tomcat</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-29_200647.png" alt></p>
<p>回到spring.factories，点开ServletWebServerFactoryAutoConfiguration类：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-29_200931.png" alt></p>
<p>spring.factories中还有WebMvcAutoConfiguration这样的类，帮我们配置好了MVC模块，我们才不用像以前在SpringMVC那样配置XML文件！</p>
<h3 id="HikariCP数据源简述"><a href="#HikariCP数据源简述" class="headerlink" title="HikariCP数据源简述"></a>HikariCP数据源简述</h3><p>HikariCP官网：<a href="https://github.com/brettwooldridge/HikariCP" target="_blank" rel="noopener">https://github.com/brettwooldridge/HikariCP</a></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-29_202204.png" alt></p>
<p>SpringBoot默认的数据源。</p>
<p>SpringBoot中已经自动装配好了HikariCP数据源，可以做到开箱即用(无需导入依赖)，如果是在SpringMVC中用，需要导入依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.zaxxer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>HikariCP<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>为什么HikariCP很快：<a href="https://github.com/brettwooldridge/HikariCP/wiki/Down-the-Rabbit-Hole" target="_blank" rel="noopener">https://github.com/brettwooldridge/HikariCP/wiki/Down-the-Rabbit-Hole</a></p>
<ul>
<li>把ArrayList换成了自定义的FastList</li>
<li>有一个并发包：ConcurrentBag–&gt;无锁设计</li>
<li>invokevirtual被invokestatic替换掉了，使得更容易被JVM优化。另外：getstatic回调没有了。另外：invokevirtual被invokestatic替换掉了，堆栈从5个减少到了4个。</li>
</ul>
<p><em>HikariCP</em>和<em>Druid</em>的对比：</p>
<ul>
<li>功能角度考虑，Druid 功能更全面，除具备连接池基本功能外，还支持sql级监控、扩展、SQL防注入等。最新版甚至有集群监控。</li>
<li>单从性能角度考虑，从数据上确实HikariCP要强，但Druid有更多、更久的生产实践，它可靠。</li>
<li>单从监控角度考虑，如果我们有像skywalking、prometheus等组件是可以将监控能力交给这些的 HikariCP也可以将metrics暴露出去。</li>
</ul>
<h3 id="数据层HikariCP与Mybatis整合"><a href="#数据层HikariCP与Mybatis整合" class="headerlink" title="数据层HikariCP与Mybatis整合"></a>数据层HikariCP与Mybatis整合</h3><p>1、导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--MySQL驱动--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Mybatis--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2、使用PDMan工具将表导入到数据库中，在application.yml中配置数据源和Mybatis：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># web访问端口号  约定8088</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8088</span></span><br><span class="line">  <span class="attr">tomcat:</span></span><br><span class="line">    <span class="attr">uri-encoding:</span> <span class="string">UTF-8</span></span><br><span class="line">  <span class="attr">max-http-header-size:</span> <span class="string">80KB</span></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 配置数据源信息</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span> <span class="comment"># 数据源的相关配置</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.zaxxer.hikari.HikariDataSource</span> <span class="comment"># 数据源类型：HikariCP</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span> <span class="comment"># mysql驱动</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/foodie-shop-dev?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line">    <span class="attr">hikari:</span></span><br><span class="line">      <span class="attr">connection-timeout:</span> <span class="number">30000</span> <span class="comment"># 等待连接池分配连接的最大时长（毫秒），超过这个时长还没可用的连接则发生SQ</span></span><br><span class="line">      <span class="attr">minimum-idle:</span> <span class="number">5</span> <span class="comment"># 最小连接数</span></span><br><span class="line">      <span class="attr">maximum-pool-size:</span> <span class="number">20</span> <span class="comment"># 最大连接数</span></span><br><span class="line">      <span class="attr">auto-commit:</span> <span class="literal">true</span> <span class="comment"># 自动提交</span></span><br><span class="line">      <span class="attr">idle-timeout:</span> <span class="number">600000</span> <span class="comment"># 连接超时的最大时长（毫秒），超时则被释放（retired），默认:10分钟</span></span><br><span class="line">      <span class="attr">pool-name:</span> <span class="string">DateSourceHikariCP</span> <span class="comment"># 连接池名字</span></span><br><span class="line">      <span class="attr">max-lifetime:</span> <span class="number">1800000</span> <span class="comment"># 连接的生命时长（毫秒），超时而且没被使用则被释放（retired），默认:30分钟</span></span><br><span class="line">      <span class="attr">connection-test-query:</span> <span class="string">SELECT</span> <span class="number">1</span></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># mybatis 配置</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">############################################################</span></span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">type-aliases-package:</span> <span class="string">com.wyqian.pojo</span> <span class="comment"># 所有POJO类所在包路径</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath:mapper/*.xml</span> <span class="comment"># mapper映射文件</span></span><br></pre></td></tr></table></figure>

<p>3、测试项目是否运行正常。maven需要重新install。重启服务后会出现：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-29_212451.png" alt></p>
<p>这是因为在导入的时候，加了一句：排除SpringBoot自带的日志工具</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以暂时把这一段注释掉，重启服务，成功！</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-29_213317.png" alt></p>
<h3 id="数据源连接数详解"><a href="#数据源连接数详解" class="headerlink" title="数据源连接数详解"></a>数据源连接数详解</h3><p><strong><em>maximum-pool-size</em></strong>：最大连接数。不是越大越好，而是根据服务器来的。比如服务器4核，可以设置为10，如果为8核，则可以设置为20。默认设置为10</p>
<p><strong><em>minimum-idle</em></strong>：最小连接数。作者是希望和最大连接数保持一致。但是为了不被闲置，可以设置一个小一点的数。</p>
<p>一般可以将这两个数设置成一样！也可以maximum-pool-size设置为大一些，minimum-idle设置为小一些。比如：maximum-pool-size设为20，minimum-idle设为5或者10.</p>
<h3 id="MyBatis-数据库逆向生成工具"><a href="#MyBatis-数据库逆向生成工具" class="headerlink" title="MyBatis 数据库逆向生成工具"></a>MyBatis 数据库逆向生成工具</h3><p> <img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-01_125306.png" alt></p>
<p>首先会有一个通用Mapper:  MyMapper类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MyMapper</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">T</span>&gt;, <span class="title">MySqlMapper</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>generatorConfig.xml：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">generatorConfiguration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"MysqlContext"</span> <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3Simple"</span> <span class="attr">defaultModelType</span>=<span class="string">"flat"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"beginningDelimiter"</span> <span class="attr">value</span>=<span class="string">"`"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"endingDelimiter"</span> <span class="attr">value</span>=<span class="string">"`"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 通用mapper所在目录 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">type</span>=<span class="string">"tk.mybatis.mapper.generator.MapperPlugin"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappers"</span> <span class="attr">value</span>=<span class="string">"com.imooc.my.mapper.MyMapper"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">"com.mysql.jdbc.Driver"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">connectionURL</span>=<span class="string">"jdbc:mysql://localhost:3306/foodie-shop-dev"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">userId</span>=<span class="string">"root"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">password</span>=<span class="string">"123456"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 对应生成的pojo所在包 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com.imooc.pojo"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!-- 对应生成的mapper所在目录 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/resources"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!-- 配置mapper对应的java映射 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com.imooc.mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span> <span class="attr">type</span>=<span class="string">"XMLMAPPER"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 数据库表 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"carousel"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"category"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"users"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"user_address"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"items"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"items_img"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"items_spec"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"items_param"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"items_comments"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"orders"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"order_items"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"order_status"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>运行GeneratorDisplay</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.imooc.mybatis.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.api.MyBatisGenerator;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.xml.ConfigurationParser;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.internal.DefaultShellCallback;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GeneratorDisplay</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generator</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">		List&lt;String&gt; warnings = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">		<span class="keyword">boolean</span> overwrite = <span class="keyword">true</span>;</span><br><span class="line">		<span class="comment">//指定 逆向工程配置文件</span></span><br><span class="line">		File configFile = <span class="keyword">new</span> File(<span class="string">"generatorConfig.xml"</span>);</span><br><span class="line">		ConfigurationParser cp = <span class="keyword">new</span> ConfigurationParser(warnings);</span><br><span class="line">		Configuration config = cp.parseConfiguration(configFile);</span><br><span class="line">		DefaultShellCallback callback = <span class="keyword">new</span> DefaultShellCallback(overwrite);</span><br><span class="line">		MyBatisGenerator myBatisGenerator = <span class="keyword">new</span> MyBatisGenerator(config,</span><br><span class="line">				callback, warnings);</span><br><span class="line">		myBatisGenerator.generate(<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">	&#125; </span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			GeneratorDisplay generatorSqlmap = <span class="keyword">new</span> GeneratorDisplay();</span><br><span class="line">			generatorSqlmap.generator();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>生成：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-01_141148.png" alt></p>
<p>tk-Mybatis和Mabatis-plus类似，可以极大地提高我们的开发效率。</p>
<h3 id="关于Restful-webservice的那些事儿"><a href="#关于Restful-webservice的那些事儿" class="headerlink" title="关于Restful webservice的那些事儿"></a>关于Restful webservice的那些事儿</h3><h4 id="Restful-Web-Service"><a href="#Restful-Web-Service" class="headerlink" title="Restful Web Service"></a>Restful Web Service</h4><ul>
<li>通信方式，比如说RPC通信，Restful也是一种通信方式。</li>
<li>信息传递</li>
<li>无状态。所有的请求对于接口来说都是无状态的</li>
<li>独立性</li>
</ul>
<h4 id="Rest设计规范"><a href="#Rest设计规范" class="headerlink" title="Rest设计规范"></a>Rest设计规范</h4><ul>
<li>GET  获取资源信息的  也就是查询的操作</li>
<li>POST  保存信息和更新资源   也可以处理一些批量的操作</li>
<li>PUT  更新资源操作</li>
<li>DELETE  删除操作</li>
</ul>
<p>URL里面不能出现一些动词，如果是动词，转换成名词！</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-02_122648.png" alt></p>
<h3 id="基于通用Mapper基于Rest编写api接口-1"><a href="#基于通用Mapper基于Rest编写api接口-1" class="headerlink" title="基于通用Mapper基于Rest编写api接口-1"></a>基于通用Mapper基于Rest编写api接口-1</h3><p>新建一张学生信息表：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-02_213922.png" alt></p>
<p>1、利用之前的mybatis-generator代码生成器，生成pojo、mapper.xml文件和StuMapper.java文件，并拷贝到我们的项目中。</p>
<p>2、写service。</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-02_214225.png" alt></p>
<p>3、写Controller。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StuFooController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StuService stuService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/getStu"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Stu <span class="title">getStu</span><span class="params">(<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> stuService.getStuInfo(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是直接这样启动会报错，原因是mapper并未扫描到我们的Spring中，这时候要在主启动类上加上一条注解：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//扫描mybatis通用mapper下所在的包</span></span><br><span class="line"><span class="meta">@MapperScan</span>(basePackages = <span class="string">"com.wyqian.mapper"</span>)</span><br></pre></td></tr></table></figure>

<p>注意@MapperScan要选：tk包下的</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/1619963132(1).png" alt></p>
<p>4、测试成功：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-02_214625.png" alt></p>
<p>另：由于idea的原因，导致这里会出现红线：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_091028.png" alt></p>
<p>为了去除红线，可以在settings里面设置一下：</p>
<p>搜索Inspections—–&gt;Spring  去掉Autowiring for bean class的方框勾选即可。</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_091233.png" alt></p>
<h3 id="基于通用Mapper基于Rest编写api接口-2"><a href="#基于通用Mapper基于Rest编写api接口-2" class="headerlink" title="基于通用Mapper基于Rest编写api接口-2"></a>基于通用Mapper基于Rest编写api接口-2</h3><p>同理，完善保存、更新和删除学生的部分</p>
<p>1、写service.</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_102636.png" alt></p>
<p>2、写Controller.</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_091947.png" alt></p>
<p>这里需要注意的是，我们按照Restful设计规范，查询操作使用GetMapping，保存、更新和删除操作使用PostMapping。</p>
<p>谈谈<strong><em>幂等性</em></strong>：<br>幂等性：就是用户对于同一操作发起的一次请求或者多次请求的结果是一致的，不会因为多次点击而产生了副作用。</p>
<p>在我们这里，更新操作和删除操作是具备幂等性的，但是保存就不具备幂等性了，因为每次保存都有可能是不一样的值。</p>
<h3 id="使用PostMan调试Restful接口"><a href="#使用PostMan调试Restful接口" class="headerlink" title="使用PostMan调试Restful接口"></a>使用PostMan调试Restful接口</h3><p>我们使用的PostMapping接口，是不可以直接使用浏览器进行调试的，但是可以借用调试工具，比如说PostMan。</p>
<p>下载地址：<a href="https://www.postman.com/downloads/" target="_blank" rel="noopener">https://www.postman.com/downloads/</a></p>
<p>1、Get请求</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_100149.png" alt></p>
<p>2、Post请求—保存操作</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_100326.png" alt></p>
<p>去数据库中查看一下，数据已经持久化完成：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_100314.png" alt></p>
<p>多次重复同一个请求：<a href="http://localhost:8088/saveStu：" target="_blank" rel="noopener">http://localhost:8088/saveStu：</a></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_100539.png" alt></p>
<p>3、Post请求—更新操作</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_102721.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_102731.png" alt></p>
<p>4、Post请求—删除操作</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_102826.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_102837.png" alt></p>
<p>彩蛋：ctrl+F12可以将当前类中的方法、属性以列表的形式展示出来！</p>
<h3 id="详解事务的传播"><a href="#详解事务的传播" class="headerlink" title="详解事务的传播"></a>详解事务的传播</h3><p><strong><em>@Transactional</em></strong></p>
<p>默认值：<img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_103248.png" alt></p>
<h4 id="REQUIRED"><a href="#REQUIRED" class="headerlink" title="REQUIRED"></a>REQUIRED</h4><p><strong>Propagation.REQUIRED</strong>：一定要使用事务，如果没有的话就创建事务，如果有的话就使用当前的事务。</p>
<p>准备工作：</p>
<p>1、先写一个TestTransactionalService 接口：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_112836.png" alt></p>
<p>2、在StuServiceImpl中实现TestTransactionalService接口：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_113003.png" alt></p>
<p>3、写一下TestTransactionalServiceImpl，将saveParent()和saveChildren()引入：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_113129.png" alt></p>
<p>测试：</p>
<p>1、首先，父Service和子Service都不加事务：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">父Service：</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>;</span><br><span class="line">子Service：</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>结果报除零错误，数据库中2条数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_113503.png" alt></p>
<p>2、父Sercice加事务，子Service不加事务：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">父Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.REQUIRED)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>;</span><br><span class="line">子Service：</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>结果报除零错误，数据库中没有数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_113730.png" alt></p>
<p>3、父Service不加事务，子Service加事务：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">父Service：</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>;</span><br><span class="line">子Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.REQUIRED)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>结果报除零错误，数据库中有1条数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_114040.png" alt></p>
<p>总结：</p>
<p>REQUIRED：使用当前的事务，如果没有加入事务，则自己新建一个事务，子方法是必须运行在一个事务的，如果当前存在事务，则加入这个事务，成为一个整体。</p>
<p>举例：领导没饭吃，我有钱，我会自己买了自己吃；领导有的吃，会分给你一起吃。</p>
<h4 id="SUPPORTS"><a href="#SUPPORTS" class="headerlink" title="SUPPORTS"></a>SUPPORTS</h4><p>测试：</p>
<p>1、父Service不加事务，子Service加事务：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">父Service：</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>;</span><br><span class="line">子Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.SUPPORTS)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>结果报除零错误，数据库中有2条数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_114953.png" alt></p>
<p>2、父Service加事务，子Service加事务：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">父Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.REQUIRED)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>;</span><br><span class="line">子Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.SUPPORTS)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>结果报除零错误，数据库中没有数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_115145.png" alt></p>
<p>总结：如果当前有事务，则使用事务；如果当前没有事务，则不使用事务。</p>
<p>举例：领导没饭吃，我也没饭吃；领导有饭吃，我也有饭吃。</p>
<h4 id="MANDATORY"><a href="#MANDATORY" class="headerlink" title="MANDATORY"></a>MANDATORY</h4><p>测试：</p>
<p>1、父Service不加事务，子Service加事务：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">父Service：</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>;</span><br><span class="line">子Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.MANDATORY)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>结果报错：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_115909.png" alt></p>
<p>这是由于父Service不加事务所导致的。</p>
<p>数据库中有1条数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_120012.png" alt></p>
<p>2、父Service加事务，子Service加事务：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">父Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.REQUIRED)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>;</span><br><span class="line">子Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.MANDATORY)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>结果报除零错，数据库中没有数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-03_120140.png" alt></p>
<p>总结：该传播属性强制必须存在一个事务，如果不存在，则抛出异常。</p>
<p>举例：领导必须管饭，不管饭没饭吃，我就不乐意了，就不干了（抛出异常）。</p>
<h4 id="REQUIRES-NEW"><a href="#REQUIRES-NEW" class="headerlink" title="REQUIRES_NEW"></a>REQUIRES_NEW</h4><p>测试：</p>
<p>1、父Service不加事务，子Service加事务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">父Service：</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>;</span><br><span class="line">子Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.REQUIRES_NEW)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>结果报除零错，数据库中有1条数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-05_153313.png" alt></p>
<p>2、父Service加事务，子Service加事务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">父Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.REQUIRED)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>;</span><br><span class="line">子Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.REQUIRES_NEW)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>并修改一下除零错的位置：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span>(propagation = Propagation.REQUIRES_NEW)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>&#123;</span><br><span class="line">    saveChild1();</span><br><span class="line">    <span class="comment">//int i = 1 / 0;</span></span><br><span class="line">    saveChild2();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span>(propagation = Propagation.REQUIRED)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>&#123;</span><br><span class="line">    stuService.saveParent();</span><br><span class="line">    stuService.saveChildren();</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">1</span> / <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果报除零错，数据库中有2条数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-05_153659.png" alt></p>
<p>如果将子Service上的<code>REQUIRES_NEW</code>改为<code>REQUIRED</code>的话，那么数据库中就没有数据！这就是<code>REQUIRES_NEW</code>和<code>REQUIRED</code>的区别。</p>
<p>总结：如果当前有事务，则挂起该事务，并且自己创建一个新的事务给自己使用；</p>
<p>如果没有事务，则同REQUIRED。</p>
<p>举例：领导有饭吃，我偏不要，我自己买了自己吃。</p>
<h4 id="NOT-SUPPORTED"><a href="#NOT-SUPPORTED" class="headerlink" title="NOT_SUPPORTED"></a>NOT_SUPPORTED</h4><p>1、父Service不加事务，子Service加事务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">父Service：</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>;</span><br><span class="line">子Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.NOT_SUPPORTED)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>结果报除零错，数据库中有2条数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-05_154839.png" alt></p>
<p>2、父Service加事务，子Service加事务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">父Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.REQUIRED)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>;</span><br><span class="line">子Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.NOT_SUPPORTED)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>结果报除零错，数据库中有1条数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-05_155049.png" alt></p>
<p>总结：如果当前有事务，则把事务挂起，自己不使用事务去运行数据库操作。</p>
<p>举例：领导有饭吃，分一点你给你，我太忙了，放一边，我不吃。</p>
<h4 id="NEVER"><a href="#NEVER" class="headerlink" title="NEVER"></a>NEVER</h4><p>1、父Service加事务，子Service加事务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">父Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.REQUIRED)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>;</span><br><span class="line">子Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.NEVER)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-05_164337.png">

<p>数据库中没有数据。</p>
<p>2、父Service不加事务，子Service加事务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">父Service：</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>;</span><br><span class="line">子Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.NEVER)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>结果报除零错，数据库中有2条数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-05_164657.png" alt></p>
<p>总结：如果当前有事务存在，则抛出异常</p>
<p>举例：领导有饭吃，我不想吃，我热爱工作，我抛出异常！</p>
<h4 id="NESTED"><a href="#NESTED" class="headerlink" title="NESTED"></a>NESTED</h4><p>1、父Service不加事务，子Service加事务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">父Service：</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>;</span><br><span class="line">子Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.NESTED)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>结果报除零错，数据库中有1条数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-05_165830.png" alt></p>
<p>2、父Service加事务，子Service加事务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">父Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.REQUIRED)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>;</span><br><span class="line">子Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.NESTED)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>并修改一下除零错的位置：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span>(propagation = Propagation.REQUIRES_NEW)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>&#123;</span><br><span class="line">    saveChild1();</span><br><span class="line">    <span class="comment">//int i = 1 / 0;</span></span><br><span class="line">    saveChild2();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span>(propagation = Propagation.REQUIRED)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>&#123;</span><br><span class="line">    stuService.saveParent();</span><br><span class="line">    stuService.saveChildren();</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">1</span> / <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果报除零错，数据库中没有数据！</p>
<p>3、父Service加事务，子Service加事务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">父Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.REQUIRED)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>;</span><br><span class="line">子Service：</span><br><span class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.NESTED)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>再修改一下除零错的位置：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span>(propagation = Propagation.REQUIRES_NEW)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveChildren</span><span class="params">()</span></span>&#123;</span><br><span class="line">    saveChild1();</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">1</span> / <span class="number">0</span>;</span><br><span class="line">    saveChild2();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span>(propagation = Propagation.REQUIRED)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>&#123;</span><br><span class="line">    stuService.saveParent();</span><br><span class="line">    stuService.saveChildren();</span><br><span class="line">    <span class="comment">//int i = 1 / 0;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果还是没有数据！</p>
<p>4、在3的基础上使用try catch设置保存点。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span>(propagation = Propagation.REQUIRED)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPropagationTrans</span><span class="params">()</span></span>&#123;</span><br><span class="line">    stuService.saveParent();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        stuService.saveChildren();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//int i = 1 / 0;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行代码，结果正确，并且数据库中有一条数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-05_170538.png" alt></p>
<p>总结：如果当前有事务，则开启子事务（嵌套事务），嵌套事务可以独立提交或者回滚；</p>
<p>如果当前没有事务，则同REQUIRED；</p>
<p>但是如果主事务提交，则会携带子事务一起提交。</p>
<p>如果主事务回滚，则子事务会一起回滚。相反，子事务异常，则父事务可以回滚或不回滚。</p>
<p>举例：领导决策不对，老板怪罪，领导带着小弟一同受罪。小弟出了差错，领导可以推卸责任。</p>
<h3 id="为何不使用-EnableTransactionManagement就能使用事务？"><a href="#为何不使用-EnableTransactionManagement就能使用事务？" class="headerlink" title="为何不使用@EnableTransactionManagement就能使用事务？"></a>为何不使用@EnableTransactionManagement就能使用事务？</h3><p>所谓开启事务管理，就是：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-05_183539.png" alt></p>
<p>但是，我们在讲事务传播的时候并没有加这条注解，但是事务依然生效，这是因为SpringBoot帮我们自动注入了事务管理！</p>
<p>spring.factories中：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-05_183313.png" alt></p>
<p>TransactionAutoConfiguration配置类中可以看到它通过Spring  AOP实现的。</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-05_184015.png" alt></p>
<h3 id="详细讲解注册登录流程"><a href="#详细讲解注册登录流程" class="headerlink" title="详细讲解注册登录流程"></a>详细讲解注册登录流程</h3><p>实现单体电商项目核心功能：</p>
<ul>
<li>用户注册与登录</li>
<li>Cookie与Session</li>
<li>集成Swagger2 api</li>
<li>分类设计与实现</li>
<li>首页商品推荐</li>
<li>商品搜索与分页</li>
<li>商品详情与评论渲染</li>
<li>购物车与订单</li>
<li>微信和支付宝支付</li>
</ul>
<h4 id="用户注册和登录流程"><a href="#用户注册和登录流程" class="headerlink" title="用户注册和登录流程"></a>用户注册和登录流程</h4><p>一般有3种方式：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-05_185215.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-05_185542.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-05_185708.png" alt></p>
<h3 id="用户注册-判断用户名存在"><a href="#用户注册-判断用户名存在" class="headerlink" title="用户注册-判断用户名存在"></a>用户注册-判断用户名存在</h3><p>密码与确认密码不一致，前后端都要做！</p>
<ul>
<li><p>前端做的话是为了减轻服务端的压力</p>
</li>
<li><p>后端做的话是为了防止某些用户绕过前端，直接访问服务器，如果服务端没有做验证的话，就可能造成黑客的攻击。</p>
</li>
</ul>
<p>在集群、微服务、分布式的环境下，所有的表id必须全局唯一！除非表的访问量非常非常小，表的数据量只有十几条，几十条，上百上千这种可以使用自增长。</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_134157.png" alt></p>
<p>我们应该从底层往上写：</p>
<p>1、新建一个UserService，</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_142152.png" alt></p>
<p>2、实现UserServiceImpl</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_142227.png" alt></p>
<p>3、写接口PassportController</p>
<p>这里用到了一个apache的工具类，判断字符串是否为空。所以要先导包：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_142434.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_142319.png" alt></p>
<h3 id="自定义响应数据结构"><a href="#自定义响应数据结构" class="headerlink" title="自定义响应数据结构"></a>自定义响应数据结构</h3><p>写好了接口之后，测试！</p>
<p>由于我们修改了服务端代码，所以需要重新安装各个模块之间的关系，install一下！</p>
<p>会发现报错了：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_142735.png" alt></p>
<p>这是由于maven在install的时候会帮我们把测试（junit）下的跑一下，所以这里我们将相关测试代码注释掉：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_143128.png" alt></p>
<p>再次install，BUILD SUCCESS!</p>
<p>启动Application，报错：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_144928.png" alt></p>
<p>springboot的事务默认是使用jdk的动态代理，即基于接口。而在注入***Impl的时候是实现类，所以我们将代理模式改成基于实现类的代理模式：</p>
<p>只需要在主启动类上将：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableTransactionManagement</span></span><br></pre></td></tr></table></figure>

<p>改成：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableTransactionManagement</span>(proxyTargetClass=<span class="keyword">true</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_145707.png" alt></p>
<p>修改之后，再次测试，成功！</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_144648.png" alt></p>
<p>这里的返回值都是写死的，在RESTFUL Service里面其实是返回的状态码，于是乎，可以将代码修改一下：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_150226.png" alt></p>
<p>这里，HttpStatus是一个枚举类。再次测试：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_150426.png" alt></p>
<p>这里返回OK，可以看源码：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_150349.png" alt></p>
<p>在后端的话，我们可以将状态码和一些业务数据封装在一起。</p>
<p>于是，写了一个工具类：IMOOCJSONResult.java</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_170017.png" alt></p>
<p>这个类中主要的属性只有三个，这样我们就可以将响应的状态、响应消息和响应的数据封装在一起，前端可以自行根据业务需求调用。</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_170149.png" alt></p>
<p>因此，我们将Controller中的内容再做修改：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_170131.png" alt></p>
<p>install maven项目，重启，再次测试：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_170449.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-06_170539.png" alt></p>
<h3 id="用户注册-创建用户Service"><a href="#用户注册-创建用户Service" class="headerlink" title="用户注册-创建用户Service"></a>用户注册-创建用户Service</h3><p>1、完成Service接口部分：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-07_214133.png" alt></p>
<p>这里使用UserBO，是将前端传过来的Json Object封装成了一个Java类：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-07_214244.png" alt></p>
<p>2、写Service的实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span>(propagation = Propagation.REQUIRED)</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Users <span class="title">createUser</span><span class="params">(UserBO userBO)</span> </span>&#123;</span><br><span class="line">    Users user = <span class="keyword">new</span> Users();</span><br><span class="line">    <span class="comment">//设置用户id</span></span><br><span class="line">    String userId  = sid.nextShort();</span><br><span class="line">    user.setId(userId);</span><br><span class="line">    <span class="comment">//设置用户名</span></span><br><span class="line">    user.setUsername(userBO.getUsername());</span><br><span class="line">    <span class="comment">//设置密码</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        user.setPassword(MD5Utils.getMD5Str(userBO.getPassword()));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//默认昵称同用户名</span></span><br><span class="line">    user.setNickname(userBO.getUsername());</span><br><span class="line">    <span class="comment">//设置默认头像</span></span><br><span class="line">    user.setFace(USER_FACE);</span><br><span class="line">    <span class="comment">//设置生日</span></span><br><span class="line">    user.setBirthday(DateUtil.stringToDate(<span class="string">"1900-01-01"</span>));</span><br><span class="line">    <span class="comment">//设置性别</span></span><br><span class="line">    user.setSex(Sex.secret.type);</span><br><span class="line">    <span class="comment">//设置创建时间和更新时间</span></span><br><span class="line">    user.setCreatedTime(<span class="keyword">new</span> Date());</span><br><span class="line">    user.setUpdatedTime(<span class="keyword">new</span> Date());</span><br><span class="line"></span><br><span class="line">    usersMapper.insert(user);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里的注意点有：</p>
<p>1、设置密码的时候需要加密，防止黑客攻击服务器的时候用户信息泄露，这里我们采用的是MD5加密方式。工具类：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-07_214542.png" alt></p>
<p>2、用户默认头像图片地址：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String USER_FACE = <span class="string">"http://122.152.205.72:88/group1/M00/00/05/CpoxxFw_8_qAIlFXAAAcIhVPdSg994.png"</span>;</span><br></pre></td></tr></table></figure>

<p>3、设置生日。使用了一个工具类，将字符串转成Date格式，工具类：<br><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-07_214845.png" alt></p>
<p>4、设置性别。写了一个枚举类，枚举类如下：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-07_214950.png" alt></p>
<p>5、设置用户id，这里为了保证全局唯一，使用了工具类生成，工具类：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-07_215123.png" alt></p>
<p>这里需要注意两点，第1、是在Spring中注入Sid类。第2、工具类所在的包需要被SpringBoot扫描到，所以在主启动类上需要加入注解：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-07_215412.png" alt></p>
<h3 id="用户注册-创建用户controller与测试"><a href="#用户注册-创建用户controller与测试" class="headerlink" title="用户注册-创建用户controller与测试"></a>用户注册-创建用户controller与测试</h3><p>之前的passPort里面写，注意点有：</p>
<p>1、需要考虑注册不成功的几种情况：</p>
<ul>
<li>用户名和密码不能为空</li>
<li>用户名不能是已经注册过的，也就是数据库中已经存在的</li>
<li>密码必须大于6位</li>
<li>密码和确认密码必须一致</li>
</ul>
<p>2、@RequestBody的作用：</p>
<p>将前端传过来的Json Object转化成Java Class   UserBO。</p>
<p>3、由于这里是保存操作，所以使用PostMapping映射方式。</p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span>(<span class="string">"/regist"</span>)</span><br><span class="line"><span class="comment">//@RequestBody作用是什么？---&gt;将前端传过来的Json Object转化成Java class</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> IMOOCJSONResult <span class="title">regist</span><span class="params">(@RequestBody UserBO userBO)</span></span>&#123;</span><br><span class="line">    String username = userBO.getUsername();</span><br><span class="line">    String password = userBO.getPassword();</span><br><span class="line">    String confirmPwd = userBO.getConfirmPassword();</span><br><span class="line">    <span class="comment">//0. 用户名和密码不能为空</span></span><br><span class="line">    <span class="keyword">if</span>(StringUtils.isBlank(username) ||</span><br><span class="line">       StringUtils.isBlank(password) ||</span><br><span class="line">       StringUtils.isBlank(confirmPwd))&#123;</span><br><span class="line">        <span class="keyword">return</span> IMOOCJSONResult.errorMsg(<span class="string">"用户名和密码不能为空"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//1. 查询用户名是否存在</span></span><br><span class="line">    <span class="keyword">boolean</span> isExist = userService.queryUserNameIsExist(username);</span><br><span class="line">    <span class="keyword">if</span>(isExist)&#123;</span><br><span class="line">        <span class="keyword">return</span> IMOOCJSONResult.errorMsg(<span class="string">"用户名已经存在"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2. 密码不能少于6位</span></span><br><span class="line">    <span class="keyword">if</span>(password.length() &lt; <span class="number">6</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> IMOOCJSONResult.errorMsg(<span class="string">"密码不能少于6位"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//3. 两次输入的密码必须保持一致</span></span><br><span class="line">    <span class="keyword">if</span>(!password.equals(confirmPwd))&#123;</span><br><span class="line">        <span class="keyword">return</span> IMOOCJSONResult.errorMsg(<span class="string">"两次输入的密码不一致"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//4. 实现注册</span></span><br><span class="line">    userService.createUser(userBO);</span><br><span class="line">    <span class="keyword">return</span> IMOOCJSONResult.ok();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试：这里由于需要传递的是Json数据，在PostMan里面需要选择Body-&gt;raw-&gt;JSON。</p>
<p>1、用户名和密码为空：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-08_091111.png" alt></p>
<p>2、用户名已经存在：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-08_091619.png" alt></p>
<p>3、密码少于6位：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-08_091252.png" alt></p>
<p>4、两次密码不一致：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-08_091232.png" alt></p>
<p>5、注册成功：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-08_091607.png" alt></p>
<h3 id="整合Swagger2文档api"><a href="#整合Swagger2文档api" class="headerlink" title="整合Swagger2文档api"></a>整合Swagger2文档api</h3><p>​    为了减少程序员撰写文档时间，提高生产力，Swagger2应运而生，使用Swagger2可以减少编写过多的文档，只需要通过代码就能生成文档API，提供给前端人员对接，非常方便。</p>
<p>1、引入依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- swagger2 配置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.xiaoymin<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-bootstrap-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>第一个依赖是核心。前两个依赖是官方提供的，最后一个是其他开发人员开发的。</p>
<p>2、写Swagger2配置类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger</span>2<span class="comment">//开启Swagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Swagger2</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//http:localhost:8088/swagger-ui.html     原路径</span></span><br><span class="line">    <span class="comment">//http:localhost:8088/doc.html     换肤</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置Swagger2核心配置   docket</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">createDocket</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)                                   <span class="comment">//指定api类型为Swagger2</span></span><br><span class="line">                    .apiInfo(apiInfo())                                                  <span class="comment">//用于定义api文档汇总信息</span></span><br><span class="line">                    .select()</span><br><span class="line">                    .apis(RequestHandlerSelectors.</span><br><span class="line">                            basePackage(<span class="string">"com.wyqian.controller"</span>))                        <span class="comment">//指定controller包</span></span><br><span class="line">                    .paths(PathSelectors.any())                                          <span class="comment">//所有controller</span></span><br><span class="line">                    .build();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> ApiInfo <span class="title">apiInfo</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiInfoBuilder()</span><br><span class="line">                .title(<span class="string">"天天吃货 电商平台接口api"</span>)         <span class="comment">//文档页标题</span></span><br><span class="line">                .contact(<span class="keyword">new</span> Contact(<span class="string">"wyqian"</span>,</span><br><span class="line">                        <span class="string">"http://wyqian.top/"</span>,</span><br><span class="line">                      <span class="string">"wanyun_qian@163.com"</span>)</span><br><span class="line">                        )                               <span class="comment">//联系人信息</span></span><br><span class="line">                .description(<span class="string">"专为天天吃货提供的api文档"</span>)  <span class="comment">//详细信息</span></span><br><span class="line">                .version(<span class="string">"1.0.1"</span>)                       <span class="comment">//文档版本号</span></span><br><span class="line">                .termsOfServiceUrl(<span class="string">"http://wyqian.top/"</span>)<span class="comment">//网站地址</span></span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在这里，使用了两种ui来展示，一种是Swagger自带的方式，另一种是使用了BootStrap美化后的ui。分别如下：</p>
<p><img src="/2021/04/27/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%B8%80%EF%BC%89/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%B8%80%EF%BC%89/H:%5Chexoblog%5Cblog%5Csource_posts%5C%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%B8%80%EF%BC%89%5C2021-05-11_202048.png" alt></p>
<p><img src="/2021/04/27/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%B8%80%EF%BC%89/%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%B8%80%EF%BC%89/H:%5Chexoblog%5Cblog%5Csource_posts%5C%E5%8D%95%E4%BD%93%E7%94%B5%E5%95%86%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%BC%80%E5%8F%91%E4%B8%8E%E4%B8%8A%E7%BA%BF%EF%BC%88%E4%B8%80%EF%BC%89%5C2021-05-11_202057.png" alt></p>
<h3 id="优化Swagger2显示"><a href="#优化Swagger2显示" class="headerlink" title="优化Swagger2显示"></a>优化Swagger2显示</h3><p>1、如果有一些controller不想展示（比如：隐私或者测试接口等等），可以使用<code>@ApiIgnore</code>注解：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-11_202736.png" alt></p>
<p>在HelloController和StuFooController上面使用该注解，重启项目：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-11_202616.png" alt></p>
<p>另外两个接口不见了！</p>
<p>2、将英文展示变成中文展示，对开发人员更友好！</p>
<p>加在Controller类上的</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-11_203943.png" alt></p>
<p>加在方法上的（POST提交）：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-11_203950.png" alt></p>
<p>加在方法上的（GET提交）：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-11_203956.png" alt></p>
<p>重启，查看ui页面：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-11_204125.png" alt></p>
<p>3、上述请求参数展示为空，可以在pojo类里配置：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-11_205039.png" alt></p>
<p>重启，查看ui页面：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-11_205211.png" alt></p>
<h3 id="使用tomcat运行前端源码"><a href="#使用tomcat运行前端源码" class="headerlink" title="使用tomcat运行前端源码"></a>使用tomcat运行前端源码</h3><p>插曲：解决tomcat启动闪退的办法：</p>
<p>在shutup.bat和shutdown.bat的文件最前面加上：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SET JAVA_HOME=C:\Program Files\Java\jdk1<span class="number">.8</span><span class="number">.0_152</span></span><br><span class="line">SET TOMCAT_HOME=D:\Environment\apache-tomcat-<span class="number">9.0</span><span class="number">.39</span>-windows-x64\apache-tomcat-<span class="number">9.0</span><span class="number">.39</span></span><br></pre></td></tr></table></figure>

<p>1、将foodie-shop静态资源文件夹复制到tomcat–&gt;webapps目录下</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-11_211129.png" alt></p>
<p>2、启动tomcat(双击shutup.bat)，在浏览器中输入url：<a href="http://localhost:8080/foodie-shop：（文件夹名即为访问路径）" target="_blank" rel="noopener">http://localhost:8080/foodie-shop：（文件夹名即为访问路径）</a></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-11_211307.png" alt></p>
<h3 id="设置跨域配置实现前后端联调"><a href="#设置跨域配置实现前后端联调" class="headerlink" title="设置跨域配置实现前后端联调"></a>设置跨域配置实现前后端联调</h3><p>跨域：前端静态资源放在了tomcat的8080端口，而后端的代码是在8088端口，前端请求后端的时候，两个端口完全不同，这就是跨域。</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-11_215154.png" alt></p>
<p>解决跨域问题：</p>
<p>1、前端配置后端服务地址serverurl：</p>
<p>将</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-11_215338.png" alt></p>
<p>修改成后端所在的接口服务地址：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-11_215511.png" alt></p>
<p>2、在后端写一个关于跨域的配置类corsConfig，允许<a href="http://localhost:8080地址的前端资源访问后端服务器。">http://localhost:8080地址的前端资源访问后端服务器。</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CorsConfig</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CorsConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CorsFilter <span class="title">corsFilter</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//1、添加cors配置信息</span></span><br><span class="line">        CorsConfiguration config = <span class="keyword">new</span> CorsConfiguration();</span><br><span class="line">        config.addAllowedOrigin(<span class="string">"http://localhost:8080"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置是否发送cookie信息</span></span><br><span class="line">        config.setAllowCredentials(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置允许请求的方式</span></span><br><span class="line">        config.addAllowedMethod(<span class="string">"*"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置允许的header</span></span><br><span class="line">        config.addAllowedHeader(<span class="string">"*"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2、为url添加映射路径</span></span><br><span class="line">        UrlBasedCorsConfigurationSource corsSource = <span class="keyword">new</span> UrlBasedCorsConfigurationSource();</span><br><span class="line">        corsSource.registerCorsConfiguration(<span class="string">"/**"</span>, config);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3、返回重新定义好的corsSource</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CorsFilter(corsSource);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3、重启项目，测试：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-12_222619.png" alt></p>
<p>后端数据库中的数据：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-12_222730.png" alt></p>
<p>可以看到，当用户名输入框输入wyqian的时候，下方已经显示了用户名已经存在的红色消息，这是通过Vue中的前后端交互工具axios实现的，相关的前端源码为;</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-12_222914.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-12_223122.png" alt></p>
<h3 id="实现用户登录"><a href="#实现用户登录" class="headerlink" title="实现用户登录"></a>实现用户登录</h3><p>1、写Service接口</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_090450.png" alt></p>
<p>2、在UserServiceImpl类中实现上面的方法。</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_090552.png" alt></p>
<p>3、写Controller，可以把前面注册的代码拿过来修改即可。</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_090651.png" alt></p>
<p>这里需要注意两点：</p>
<p>1、前端拿到的password需要经过MD5加密之后与后端数据库中的数据作比较。</p>
<p>2、由于登陆操作不需要写confirmPassword，所以UserBO实体类中，将confirmPassword属性的swagger注解的required设置成false。</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_091015.png" alt></p>
<p>4、maven项目重新install，重启项目。</p>
<ul>
<li><p>swagger-ui页面测试：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_092304.png" alt></p>
</li>
<li><p>真实项目测试也没有问题，登陆成功！</p>
</li>
</ul>
<p>这部分前端源码展示：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_092412.png" alt></p>
<p>其中，res就是从后端拿到的数据，为了查看拿到的数据，这里我们加上debugger，在浏览器中测试，可以看到res中有我们后端的IMOOCJSONResult对象数据。</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20210513092026.png" alt></p>
<h3 id="回顾cookie和session"><a href="#回顾cookie和session" class="headerlink" title="回顾cookie和session"></a>回顾cookie和session</h3><p>cookie:</p>
<ul>
<li>以键值对形式存储信息在浏览器，其实就是存储在浏览器上的缓存。cookie大小是有限制的，一般不能超过4KB。</li>
<li>cookie不能跨域，当前及其父级域名可以取值</li>
<li>cookie可以设置有效期</li>
<li>cookie可以设置path</li>
</ul>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_094147.png" alt></p>
<p>session:</p>
<ul>
<li>基于服务器内存的缓存（非持久化），可保存请求会话。</li>
<li>每个session通过sessionid来区分不同请求。</li>
<li>session可设置过期时间</li>
<li>session也是以键值对形式存在的。</li>
</ul>
<p>Session例子：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_100224.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_100143.png" alt></p>
<h3 id="实现用户信息在页面显示"><a href="#实现用户信息在页面显示" class="headerlink" title="实现用户信息在页面显示"></a>实现用户信息在页面显示</h3><p>通过cookie实现！</p>
<p>1、导入CookieUtils和JsonUtils工具类</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_103642.png" alt></p>
<p>2、在login接口中设置cookie。注意这里由于安全性考虑（比如说公用电脑，个人信息保存在cookie中不安全等），需要将一些属性赋为空，才能传到前端。</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_103911.png" alt></p>
<p>其中，cookie名”user”是与前端对应的：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_104026.png" alt></p>
<p>3、启动测试。</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20210513103233.png" alt></p>
<p>4、注册的接口也加上同样的设置cookie代码。测试：</p>
<ol>
<li><p>首先退出当前登录，这里由于还没做退出登陆的功能，所以直接删除浏览器中cookie信息：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_104500.png" alt></p>
</li>
<li><p>点击注册。注册完毕后首页：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_104613.png" alt></p>
</li>
</ol>
<h3 id="整合log4j打印日志"><a href="#整合log4j打印日志" class="headerlink" title="整合log4j打印日志"></a>整合log4j打印日志</h3><p>由于springboot自带的日志框架有些冗余，我们可以剔除springboot自带的日志框架：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_111128.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_110644.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_110836.png" alt></p>
<p>添加日志框架依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--引入日志依赖 抽象层 与 实现层--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>引入依赖后重启项目，控制台信息：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_112124.png" alt></p>
<p>加上配置文件：log.properties，控制台消息正常！</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_112332.png" alt></p>
<p>测试日志级别：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义一个logger</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">static</span> Logger logger = LoggerFactory.getLogger(HelloController<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        logger.info(<span class="string">"info: hello,nju!"</span>);</span><br><span class="line">        logger.warn(<span class="string">"warn: hello,nju!"</span>);</span><br><span class="line">        logger.debug(<span class="string">"debug: hello,nju!"</span>);</span><br><span class="line">        logger.error(<span class="string">"error: hello,nju!"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello World~"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>启动项目，访问<a href="http://localhost:8088/hello，控制台消息：" target="_blank" rel="noopener">http://localhost:8088/hello，控制台消息：</a></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_123101.png" alt></p>
<p>可以看到日志级别为info级别的情况下，是看不到debug的消息的。重新设置，改成DEBUG：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_123358.png" alt></p>
<p>再次启动项目，访问<a href="http://localhost:8088/hello，控制台消息为：" target="_blank" rel="noopener">http://localhost:8088/hello，控制台消息为：</a></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-13_123517.png" alt></p>
<p>这时候DEBUG级别的消息也打印了出来。</p>
<h3 id="通过日志监控service执行时间"><a href="#通过日志监控service执行时间" class="headerlink" title="通过日志监控service执行时间"></a>通过日志监控service执行时间</h3><p>1、导入AOP的包</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2、由于通过日志监控service执行时间是通过AOP实现的，于是乎，在foodie-dev-api下新建一个aspect包，然后新建一个类，并写一个切入的方法。</p>
<p>这里采用的是环绕通知。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span><span class="comment">//标注这个类是一个切面</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServiceLogAspect</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * AOP通知：</span></span><br><span class="line"><span class="comment">     * 1、前置通知：在方法调用之前执行</span></span><br><span class="line"><span class="comment">     * 2、后置通知：在方法正常调用之后执行</span></span><br><span class="line"><span class="comment">     * 3、环绕通知：在方法调用之前和之后，都分别可以执行的通知</span></span><br><span class="line"><span class="comment">     * 4、异常通知：如果载方法调用过程中发生异常，则通知</span></span><br><span class="line"><span class="comment">     * 5、最终通知：在方法调用之后执行，与2区别开来，可以理解为try catch里面的finally</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log =</span><br><span class="line">            LoggerFactory.getLogger(ServiceLogAspect<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 切面表达式：</span></span><br><span class="line"><span class="comment">     * execution  代表所要执行的表达式主体</span></span><br><span class="line"><span class="comment">     * 第一处 * 代表方法返回类型，*代表所有类型</span></span><br><span class="line"><span class="comment">     * 第二处 包名代表aop监控的类所在的包</span></span><br><span class="line"><span class="comment">     * 第三处 .. 代表该包及其子包下的所有类方法</span></span><br><span class="line"><span class="comment">     * 第四处 * 代表类名  *代表所有类</span></span><br><span class="line"><span class="comment">     * 第五处 *(..) *表示类中的方法名，(..)表示方法中的任何参数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> joinPoint</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Throwable</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Around</span>(<span class="string">"execution(* com.wyqian.service.serviceImpl..*.*(..))"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">recordTimeLog</span><span class="params">(ProceedingJoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        log.info(<span class="string">"===== 开始执行 &#123;&#125;.&#123;&#125; ====="</span>,</span><br><span class="line">                        joinPoint.getTarget().getClass(),</span><br><span class="line">                        joinPoint.getSignature().getName());</span><br><span class="line">        <span class="comment">//记录开始时间</span></span><br><span class="line">        <span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//执行目标</span></span><br><span class="line">        Object result = joinPoint.proceed();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//记录结束时间</span></span><br><span class="line">        <span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">long</span> takeTime = end - start;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(takeTime &gt; <span class="number">3000</span>)&#123;</span><br><span class="line">            log.error(<span class="string">"===== 执行结束，耗时：&#123;&#125;毫秒 ====="</span>, takeTime);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(takeTime &gt; <span class="number">2000</span>)&#123;</span><br><span class="line">            log.warn(<span class="string">"===== 执行结束，耗时：&#123;&#125;毫秒 ====="</span>, takeTime);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            log.info(<span class="string">"===== 执行结束，耗时：&#123;&#125;毫秒 ====="</span>, takeTime);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里注意一个写法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Around</span>(<span class="string">"execution(* com.wyqian.service.serviceImpl..*.*(..))"</span>)</span><br></pre></td></tr></table></figure>

<p>我们之前写的是这样的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Around</span>(<span class="string">"execution(* com.wyqian.service.UserServiceImpl.*(..))"</span>)</span><br></pre></td></tr></table></figure>

<p>发现比上面的写法少了..*，这是因为serviceImpl是一个包，加..星是因为.. 代表该包及其子包下的所有类方法，而星表示所有类。而之前的写法中UserServiceImpl本身就是一个类！</p>
<p>3、重启项目，测试</p>
<ul>
<li>1、我们执行了一个登陆操作：</li>
</ul>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-14_094700.png" alt></p>
<ul>
<li><p>2、我们加入休眠代码，创造error和warn级别的日志。</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-14_095046.png" alt></p>
</li>
</ul>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-14_095117.png" alt></p>
<p>再次测试，结果：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-14_095031.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-14_095244.png" alt></p>
<p>由于在log.properties中配置了写入到文件，所以在本地也会有日志记录：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-14_100939.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-14_101146.png" alt></p>
<h3 id="用户退出登录清空cookie"><a href="#用户退出登录清空cookie" class="headerlink" title="用户退出登录清空cookie"></a>用户退出登录清空cookie</h3><p>前端源码：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-14_102931.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-14_102554.png" alt></p>
<p>因此，我们需要在passport中新加一个logout的接口：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-14_102554.png" alt></p>
<p>测试：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-14_102812.png" alt></p>
<h3 id="开启Mybatis日志Sql打印"><a href="#开启Mybatis日志Sql打印" class="headerlink" title="开启Mybatis日志Sql打印"></a>开启Mybatis日志Sql打印</h3><p>在生产环境中，我们一般不会去打印出SQL语句，但是在开发环境中，开启SQL日志，可以帮助我们更好定位和判断哪里写错了。</p>
<p>在Mybatis的配置文件处，加上一条关于日志的配置，这里我们选择stdoutImpl:</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-14_104243.png" alt></p>
<p>重启项目，测试：</p>
<p>登录操作：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-14_104448.png" alt></p>
<p>注册操作：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-05-14_104636.png" alt></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
    
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://wyqian.top/2021/04/26/%E9%98%BF%E9%87%8C%E4%BA%91%E7%9F%AD%E4%BF%A1%E4%B8%9A%E5%8A%A1%E5%AE%9E%E6%88%98/%E9%98%BF%E9%87%8C%E4%BA%91%E7%9F%AD%E4%BF%A1%E4%B8%9A%E5%8A%A1%E5%AE%9E%E6%88%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="精进的coder">
      <meta itemprop="description" content="Do not talk, show me your code!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SC&KD's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/26/%E9%98%BF%E9%87%8C%E4%BA%91%E7%9F%AD%E4%BF%A1%E4%B8%9A%E5%8A%A1%E5%AE%9E%E6%88%98/%E9%98%BF%E9%87%8C%E4%BA%91%E7%9F%AD%E4%BF%A1%E4%B8%9A%E5%8A%A1%E5%AE%9E%E6%88%98/" class="post-title-link" itemprop="url">阿里云短信业务实战</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-26 16:02:16" itemprop="dateCreated datePublished" datetime="2021-04-26T16:02:16+08:00">2021-04-26</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/04/26/%E9%98%BF%E9%87%8C%E4%BA%91%E7%9F%AD%E4%BF%A1%E4%B8%9A%E5%8A%A1%E5%AE%9E%E6%88%98/%E9%98%BF%E9%87%8C%E4%BA%91%E7%9F%AD%E4%BF%A1%E4%B8%9A%E5%8A%A1%E5%AE%9E%E6%88%98/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/04/26/%E9%98%BF%E9%87%8C%E4%BA%91%E7%9F%AD%E4%BF%A1%E4%B8%9A%E5%8A%A1%E5%AE%9E%E6%88%98/%E9%98%BF%E9%87%8C%E4%BA%91%E7%9F%AD%E4%BF%A1%E4%B8%9A%E5%8A%A1%E5%AE%9E%E6%88%98/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>5.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>5 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="阿里云短信服务"><a href="#阿里云短信服务" class="headerlink" title="阿里云短信服务"></a>阿里云短信服务</h1><blockquote>
<p>了解阿里云用户权限操作</p>
</blockquote>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-26_160729.png" alt></p>
<p>1、开启子用户</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/6a39599c94c9e1e296c5071d1177ec6.png" alt></p>
<p>2、新建一个用户组，并设置添加权限 sms短信服务</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-26_162710.png" alt></p>
<p>3、创建一个用户，具体用来操作的账号</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-26_163000.png" alt></p>
<p>4、得到AccessKey（id，密码）</p>
<p><strong><em>注意：要将这个账号保存下来</em></strong></p>
<blockquote>
<p>开通阿里云短信服务</p>
</blockquote>
<p>1、找到阿里云短信服务控制台面板</p>
<p>直接在阿里云官网搜索即可。</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-04-26_164949.png" alt></p>
<p>2、找到帮助文档</p>
<p><a href="https://help.aliyun.com/document_detail/102715.html?spm=5176.12212976.0.dexternal.20dd1cbepYi0UX" target="_blank" rel="noopener">https://help.aliyun.com/document_detail/102715.html?spm=5176.12212976.0.dexternal.20dd1cbepYi0UX</a></p>
<blockquote>
<p>添加短信模板</p>
</blockquote>
<p>1、短信的具体内容</p>
<p>2、等待审核通过（需要正当的理由）</p>
<blockquote>
<p>添加签名</p>
</blockquote>
<p>1、公司的名称</p>
<p>2、等待审核通过（需要正当的理由）</p>
<blockquote>
<p>编写测试代码</p>
</blockquote>
<p>1、新建一个SpringBoot项目</p>
<p>2、导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.aliyun<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aliyun-java-sdk-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.5.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.76<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3、编写代码测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wyqian;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.aliyuncs.CommonRequest;</span><br><span class="line"><span class="keyword">import</span> com.aliyuncs.CommonResponse;</span><br><span class="line"><span class="keyword">import</span> com.aliyuncs.DefaultAcsClient;</span><br><span class="line"><span class="keyword">import</span> com.aliyuncs.IAcsClient;</span><br><span class="line"><span class="keyword">import</span> com.aliyuncs.exceptions.ClientException;</span><br><span class="line"><span class="keyword">import</span> com.aliyuncs.exceptions.ServerException;</span><br><span class="line"><span class="keyword">import</span> com.aliyuncs.http.MethodType;</span><br><span class="line"><span class="keyword">import</span> com.aliyuncs.profile.DefaultProfile;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AliyunsmsdemoApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//连接阿里云</span></span><br><span class="line">        DefaultProfile profile = DefaultProfile.getProfile(<span class="string">"cn-qingdao"</span>, <span class="string">"LTAI5tFdaicWmFstmbDawtTt"</span>, <span class="string">"pr6o4dhpMJfg8FwBNBkJLF6LCpDhCk"</span>);</span><br><span class="line">        IAcsClient client = <span class="keyword">new</span> DefaultAcsClient(profile);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//构建请求</span></span><br><span class="line">        CommonRequest request = <span class="keyword">new</span> CommonRequest();</span><br><span class="line"></span><br><span class="line">        request.setSysMethod(MethodType.POST);</span><br><span class="line">        request.setSysDomain(<span class="string">"dysmsapi.aliyuncs.com"</span>);<span class="comment">//不要动</span></span><br><span class="line">        request.setSysVersion(<span class="string">"2017-05-25"</span>);<span class="comment">//不要动</span></span><br><span class="line">        request.setSysAction(<span class="string">"SendSms"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//自定义参数（手机号，验证码，签名，模板）</span></span><br><span class="line">        request.putQueryParameter(<span class="string">"PhoneNumbers"</span>, <span class="string">"15573147750"</span>);</span><br><span class="line">        request.putQueryParameter(<span class="string">"SignName"</span>, <span class="string">"学习"</span>);</span><br><span class="line">        request.putQueryParameter(<span class="string">"TemplateCode"</span>, <span class="string">"SMS_215802812"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//构建一个短信验证码</span></span><br><span class="line">        HashMap&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">"code"</span>, <span class="number">2233</span>);</span><br><span class="line">        request.putQueryParameter(<span class="string">"TemplateParam"</span>, JSONObject.toJSONString(map));</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            CommonResponse response = client.getCommonResponse(request);</span><br><span class="line">            System.out.println(response.getData());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ServerException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClientException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>编写可复用的微服务接口，实现验证码的发送！</p>
</blockquote>
<p>Service层接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wyqian.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SendSms</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">send</span><span class="params">(String phoneNum, String templateCode, Map&lt;String, Object&gt; code)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Service层实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wyqian.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.aliyuncs.CommonRequest;</span><br><span class="line"><span class="keyword">import</span> com.aliyuncs.CommonResponse;</span><br><span class="line"><span class="keyword">import</span> com.aliyuncs.DefaultAcsClient;</span><br><span class="line"><span class="keyword">import</span> com.aliyuncs.IAcsClient;</span><br><span class="line"><span class="keyword">import</span> com.aliyuncs.exceptions.ClientException;</span><br><span class="line"><span class="keyword">import</span> com.aliyuncs.exceptions.ServerException;</span><br><span class="line"><span class="keyword">import</span> com.aliyuncs.http.MethodType;</span><br><span class="line"><span class="keyword">import</span> com.aliyuncs.profile.DefaultProfile;</span><br><span class="line"><span class="keyword">import</span> com.wyqian.service.SendSms;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SendSmsImpl</span> <span class="keyword">implements</span> <span class="title">SendSms</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">send</span><span class="params">(String phoneNum, String templateCode, Map&lt;String, Object&gt; code)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//连接阿里云</span></span><br><span class="line">        DefaultProfile profile = DefaultProfile.getProfile(<span class="string">"cn-qingdao"</span>, <span class="string">"LTAI5tFdaicWmFstmbDawtTt"</span>, <span class="string">"pr6o4dhpMJfg8FwBNBkJLF6LCpDhCk"</span>);</span><br><span class="line">        IAcsClient client = <span class="keyword">new</span> DefaultAcsClient(profile);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//构建请求</span></span><br><span class="line">        CommonRequest request = <span class="keyword">new</span> CommonRequest();</span><br><span class="line"></span><br><span class="line">        request.setSysMethod(MethodType.POST);</span><br><span class="line">        request.setSysDomain(<span class="string">"dysmsapi.aliyuncs.com"</span>);<span class="comment">//不要动</span></span><br><span class="line">        request.setSysVersion(<span class="string">"2017-05-25"</span>);<span class="comment">//不要动</span></span><br><span class="line">        request.setSysAction(<span class="string">"SendSms"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//自定义参数（手机号，验证码，签名，模板）</span></span><br><span class="line">        request.putQueryParameter(<span class="string">"PhoneNumbers"</span>, phoneNum);</span><br><span class="line">        request.putQueryParameter(<span class="string">"SignName"</span>, <span class="string">"学习"</span>);</span><br><span class="line">        request.putQueryParameter(<span class="string">"TemplateCode"</span>, templateCode);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//构建一个短信验证码</span></span><br><span class="line">        request.putQueryParameter(<span class="string">"TemplateParam"</span>, JSONObject.toJSONString(code));</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            CommonResponse response = client.getCommonResponse(request);</span><br><span class="line">            System.out.println(response.getData());</span><br><span class="line">            <span class="keyword">return</span> response.getHttpResponse().isSuccess();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ServerException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClientException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Controller层实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wyqian.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.wyqian.service.SendSms;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.CrossOrigin;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span>  <span class="comment">//跨域支持</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SmsApiController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SendSms sendSms;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, String&gt; redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/send/&#123;phone&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">code</span><span class="params">(@PathVariable(<span class="string">"phone"</span>)</span> String phone)</span>&#123;</span><br><span class="line">        <span class="comment">//调用发送方法（模拟真实业务 redis）</span></span><br><span class="line">        String code = redisTemplate.opsForValue().get(phone);</span><br><span class="line">        <span class="keyword">if</span>(!StringUtils.isEmpty(code))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"phone : "</span> + code + <span class="string">"已存在，还没有过期"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//生成验证码并存储到Redis中</span></span><br><span class="line">        code = UUID.randomUUID().toString().substring(<span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">        HashMap&lt;String, Object&gt; param = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        param.put(<span class="string">"code"</span>, code);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">boolean</span> isSend = sendSms.send(phone, <span class="string">"SMS_215802812"</span>, param);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(isSend)&#123;</span><br><span class="line">            <span class="comment">//如果发送成功，就将验证码存储到Redis中，并设置过期时间。</span></span><br><span class="line">            redisTemplate.opsForValue().set(phone, code, <span class="number">5</span>, TimeUnit.MINUTES);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"phone : "</span> + code + <span class="string">"发送成功！"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"发送失败！"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
    
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://wyqian.top/2021/03/25/JVM%E6%8E%A2%E7%A9%B6/JVM%E6%8E%A2%E7%A9%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="精进的coder">
      <meta itemprop="description" content="Do not talk, show me your code!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SC&KD's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/25/JVM%E6%8E%A2%E7%A9%B6/JVM%E6%8E%A2%E7%A9%B6/" class="post-title-link" itemprop="url">JVM探究</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-03-25 14:25:22" itemprop="dateCreated datePublished" datetime="2021-03-25T14:25:22+08:00">2021-03-25</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/03/25/JVM%E6%8E%A2%E7%A9%B6/JVM%E6%8E%A2%E7%A9%B6/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/03/25/JVM%E6%8E%A2%E7%A9%B6/JVM%E6%8E%A2%E7%A9%B6/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>5.4k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>5 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <a id="more"></a>

<h1 id="JVM探究"><a href="#JVM探究" class="headerlink" title="JVM探究"></a>JVM探究</h1><ul>
<li>请你谈谈你对JVM的理解？Java8虚拟机和之前的变化更新？</li>
<li>什么是OOM，什么是栈溢出 StackOverFlowError?怎么分析？</li>
<li>JVM的常用调优参数有哪些？</li>
<li>内存快照如何抓取？怎么分析Dump文件？知道吗？</li>
<li>谈谈JVM中，类加载器你的认识？rt.jar  ext  application</li>
</ul>
<ol>
<li><p>JVM的位置</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_144404.png" alt></p>
</li>
<li><p>JVM的体系机构</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_145025.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_145213.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_145320.png" alt></p>
</li>
<li><p>类加载器</p>
<p>作用：加载Class文件~new Student();</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_152622.png" alt></p>
<ol>
<li><p>虚拟机自带的加载器</p>
</li>
<li><p>启动类（根）加载器</p>
</li>
<li><p>扩展类加载器</p>
</li>
<li><p>应用程序加载器</p>
</li>
<li><p>百度：<strong><em>双亲委派机制</em></strong></p>
<p><a href="https://blog.csdn.net/codeyanbao/article/details/82875064" target="_blank" rel="noopener">https://blog.csdn.net/codeyanbao/article/details/82875064</a></p>
</li>
</ol>
</li>
<li><p>双亲委派机制</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/20201217213314510.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> java.lang;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">String</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//双亲委派机制：安全</span></span><br><span class="line">    <span class="comment">//1.APP--&gt;EXC---Bootstrap(最终执行)</span></span><br><span class="line">    <span class="comment">//ROOT</span></span><br><span class="line">    <span class="comment">//EXC</span></span><br><span class="line">    <span class="comment">//APP</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s = <span class="keyword">new</span> String();</span><br><span class="line">        System.out.println(s.toString());</span><br><span class="line">        System.out.println(s.getClass().getClassLoader());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    1. 类加载器收到类加载的请求</span></span><br><span class="line"><span class="comment">    2. 将这个请求向上委托给父类加载器去完成，一直向上委托，直到启动类加载器</span></span><br><span class="line"><span class="comment">    3. 启动加载器检查是否能够加载当前这个类，能加在就结束，使用当前的加载器，否则，抛出异常，通知子加载器进行加载</span></span><br><span class="line"><span class="comment">    4. 重复步骤3</span></span><br><span class="line"><span class="comment">    Class Not Found~</span></span><br><span class="line"><span class="comment">    null: java调用不到~ C  C++</span></span><br><span class="line"><span class="comment">    Java ==&gt; C++ 去掉了指针和内存管理，于是乎Java被称为C++--</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//类是抽象的模板，对象是具体的</span></span><br><span class="line"><span class="comment">//        Class&lt;Car&gt; carClass = Car.class;</span></span><br><span class="line"></span><br><span class="line">        Car car1 = <span class="keyword">new</span> Car();</span><br><span class="line">        Car car2 = <span class="keyword">new</span> Car();</span><br><span class="line">        Car car3 = <span class="keyword">new</span> Car();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Class&lt;? extends Car&gt; aClass = car1.getClass();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        ClassLoader classLoader = aClass.getClassLoader();<span class="comment">//AppClassLoader</span></span><br><span class="line">        System.out.println(aClass.getClassLoader());</span><br><span class="line">        ClassLoader parent = classLoader.getParent();<span class="comment">//ExtClassLoader   \jre1.8.0_152\lib\ext</span></span><br><span class="line">        System.out.println(parent);</span><br><span class="line">        ClassLoader parentParent = parent.getParent();<span class="comment">//null  1.不存在   2.java程序获取不到~   rt.jar</span></span><br><span class="line">        System.out.println(parentParent);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>沙箱安全机制</p>
<p>​    Java安全模型的核心就是Java沙箱（sandbox），什么是沙箱？沙箱是一个限制程序运行的环境。沙箱机制就是将Java代码限定在虚拟机（JVM）特定的运行范围中，并且严格限制代码对本地系统资源的访问，通过这样的措施来保护对代码的有效隔离，防止对本地系统造成破坏。沙箱主要限制系统资源访问，那系统资源包括什么？CPU、内存、文件系统、网络。不同级别的沙箱对这些资源访问的限制也可以不一样。</p>
<p>​    所有的java程序都可以指定沙箱，可以定制安全策略。</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_165143.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_165219.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_165318.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_165531.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_170142.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_170419.png" alt></p>
</li>
<li><p>Native</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Thread(()-&gt; &#123;</span><br><span class="line">        &#125;, <span class="string">"my thread name"</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    native：凡是带了native关键字的，说明java的范围达不到了，回去调用底层C语言的库</span></span><br><span class="line"><span class="comment">    会进入本地方法栈</span></span><br><span class="line"><span class="comment">    调用本地方法本地接口  JNI</span></span><br><span class="line"><span class="comment">    JNI作用：扩展Java的使用，融合不同的编程语言为Java所用！最初：C、C++</span></span><br><span class="line"><span class="comment">    Java诞生的时候C、C++横行，想要立足，必须要有调用C、C++的程序</span></span><br><span class="line"><span class="comment">    他在内存区域中专门开辟了一块标记区域：Native Method Stack,登记native方法</span></span><br><span class="line"><span class="comment">    在最终执行的时候，加载本地方法库中的方法通过JNI</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//java程序驱动打印机，管理系统，掌握即可，在企业级应用中较为少见！</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">start0</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//调用其他接口(异构领域间通信)：Socket、WebService、http</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>PC寄存器</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-26_090045.png" alt></p>
</li>
<li><p>方法区</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-26_090800.png" alt></p>
</li>
<li><p>栈：数据结构</p>
<p>程序 = 数据结构 + 算法：持续学习~</p>
<p>程序 = 框架 + 业务逻辑<del>：吃饭</del></p>
<p>栈：先进后出、后进先出：桶</p>
<p>队列：先进先出（FIFO：First Input First Output）</p>
<p>喝多了吐就是栈，吃多了拉就是队列</p>
<p>为什么main()先执行，最后结束~</p>
<p>栈：栈内存，主管程序的运行，生命周期和线程同步；</p>
<p>线程结束，栈内存也就是释放了，对于栈来说，不存在垃圾回收问题</p>
<p>一旦线程结束，栈就Over!</p>
<p>栈：8大基本类型+对象引用+实例的方法</p>
<p>栈运行原理：栈帧</p>
<p>栈满了：StackOverFlowError</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-26_092948.png" alt></p>
</li>
</ol>
<p>   栈+堆+方法区   交互关系</p>
<p>   <img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-26_093341.png" alt></p>
<p>   <strong>画出一个对象实例化的过程在内存中：百度、看视频~</strong></p>
<p>   <a href="https://blog.csdn.net/Tony__Jaa/article/details/107612059" target="_blank" rel="noopener">https://blog.csdn.net/Tony__Jaa/article/details/107612059</a></p>
<ol start="10">
<li><p>三种JVM</p>
<ul>
<li>Sun公司   HotSpot</li>
<li>BEA  JRockit</li>
<li>IBM  J9VM</li>
</ul>
<p>我们学习都是：HotSpot</p>
</li>
<li><p>堆</p>
<p>Heap，一个JVM只有一个堆内存，堆内存的大小是可以调节的。</p>
<p>类加载器读取了类文件后，一般会把什么东西放到堆中呢？类，方法，常量，变量~，保存我们所有引用类型的真实对象！</p>
<p>堆内存中还要细分为三个区域：</p>
<ul>
<li>新生区  Young/New（伊甸园区）</li>
<li>养老区  old</li>
<li>永久区  Perm</li>
</ul>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-26_134802.png" alt></p>
<p>GC垃圾回收主要是在伊甸园区和养老区~</p>
<p>假设内存满了，OOM，堆内存不够!</p>
<p>在jdk8以后，永久存储区有另外一个名字（元空间）</p>
</li>
<li><p>新生区</p>
<ul>
<li>类：诞生和成长的地方，甚至死亡；</li>
<li>伊甸园，所有的对象都是在伊甸园区new出来的！</li>
<li>幸存者区（0，1）</li>
<li><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-27_193806.png" alt></li>
</ul>
<p>真理：经过研究，99%的对象都是临时对象！</p>
</li>
<li><p>老年区</p>
</li>
<li><p>永久区</p>
<p>这个区域常驻内存的，用来存放JDK自身携带的Class对象。Interface元数据，存储的是Java运行时的一些环境或类信息<del>这个区域不存在垃圾回收！关闭虚拟机就会释放这个区域的内存</del></p>
<p>一个启动类，加载了大量的第三方jar包。Tomcat部署了太多的应用，大量动态生成的反射类。不断地被加载，直到内存满，就会出现OOM；</p>
<ul>
<li><p>jdk1.6之前，永久代，常量池是在方法区中；</p>
</li>
<li><p>jdk1.7，永久代，但是慢慢的退化了，<code>去永久代</code>，常量池在堆中</p>
</li>
<li><p>jdk1.8之后，无永久代，常量池在元空间</p>
</li>
<li><p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-27_195510.png" alt></p>
</li>
<li><p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-27_195405.png" alt></p>
</li>
</ul>
<p>元空间逻辑上存在，物理上不存在~</p>
</li>
<li><p>堆内存调优</p>
<p>例子1：元空间逻辑上存在，物理上不存在</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//返回虚拟机试图使用的最大内存</span></span><br><span class="line">        <span class="keyword">long</span> max = Runtime.getRuntime().maxMemory();</span><br><span class="line">        <span class="comment">//返回jvm的总内存</span></span><br><span class="line">        <span class="keyword">long</span> total = Runtime.getRuntime().totalMemory();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"max="</span> + max +<span class="string">"字节\t"</span> + (max/(<span class="keyword">double</span>)<span class="number">1024</span>/<span class="number">1024</span>)+<span class="string">"MB"</span>);</span><br><span class="line">        System.out.println(<span class="string">"total="</span> + total +<span class="string">"字节\t"</span> + (total/(<span class="keyword">double</span>)<span class="number">1024</span>/<span class="number">1024</span>)+<span class="string">"MB"</span>);</span><br><span class="line">        <span class="comment">// 默认情况下：分配的总内存(max)是电脑内存的1/4，而初始化内存(total)：1/64</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//OOM:</span></span><br><span class="line">            <span class="comment">//1、尝试扩大堆内存看结果，如果堆内存扩大了程序还报OOM，那说明是程序写错了</span></span><br><span class="line">            <span class="comment">//2、分析内存，看一下哪个地方出现了问题（专业工具）</span></span><br><span class="line">        <span class="comment">//-Xms1024m -Xmx1024m -XX:+PrintGCDetails</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//305664K(新生代)+699392K(老年代)=981.5MB</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>例子2：轻重GC展示</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="comment">//-Xms8m -Xmx8m -XX:+PrintGCDetails</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String str = <span class="string">"wyqian"</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">            str += str + <span class="keyword">new</span> Random().nextInt(<span class="number">99999999</span>)+<span class="keyword">new</span> Random().nextInt(<span class="number">88888888</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-27_203215.png" alt></p>
<p>在一个项目中，突然出现OOM故障，那么该如何排除？研究为什么出错~</p>
<ul>
<li>能够看到代码第几行出错：内存快照分析工具，MAT，JProfiler</li>
<li>Debug，一行行分析代码！</li>
</ul>
<p><strong><em>MAT，JProfiler作用：</em></strong></p>
<ul>
<li>分析Dump内存文件，快读定位内存泄漏；</li>
<li>获得堆中的数据</li>
<li>获得大的对象~</li>
<li>……</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="comment">//-Xms：设置初始化分配内存大小 默认1/64</span></span><br><span class="line"><span class="comment">//-Xmx：设置最大分配内存大小 默认1/4</span></span><br><span class="line"><span class="comment">//-XX:PrintGCDetails  打印GC垃圾回收信息</span></span><br><span class="line"><span class="comment">//-Xms1m -Xmx8m -XX:+HeapDumpOnOutOfMemoryError   OOM Dump文件</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo03</span> </span>&#123;</span><br><span class="line">    <span class="keyword">byte</span>[] array = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>*<span class="number">1024</span>];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ArrayList&lt;Demo03&gt; list = <span class="keyword">new</span> ArrayList&lt;Demo03&gt;();</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">                list.add(<span class="keyword">new</span> Demo03());</span><br><span class="line">                count++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Error e)&#123;</span><br><span class="line">            System.out.println(<span class="string">"count:"</span>+count);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-28_102356.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-28_102412.png" alt></p>
</li>
<li><p>GC：垃圾回收机制，不能手动回收</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-28_163610.png" alt></p>
<p>JVM在进行GC时，并不是对这三个区域统一回收。大部分时候，回收都是新生代~</p>
<ul>
<li>伊甸园区</li>
<li>幸存区（from， to）</li>
<li>老年区</li>
</ul>
<p>GC两种类：轻GC(普通的GC)、重GC(全局GC)</p>
<p>题目：</p>
<ul>
<li>JVM的内存模型和分区~详细到每一个区放什么</li>
<li>堆里面的分区有哪些？Eden，from，to，老年区，说说他们的特点！</li>
<li>GC的算法有哪些？标记清除法，标记整理法，复制算法，引用计数法，怎么用的？</li>
<li>轻GC和重GC分别在什么时候发生？</li>
</ul>
<p><strong><em>引用计数法：</em></strong></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-28_164559.png" alt></p>
<p><strong><em>复制算法：</em></strong></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-28_165649.png" alt></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-28_170110.png" alt></p>
<ul>
<li>好处：没有内存的碎片</li>
<li>坏处：浪费了内存空间~：多了一半空间永远是空to。假设对象100%存活（极端情况）</li>
</ul>
<p>复制算法最佳使用场景：对象存活度较低的时候；新生区~</p>
<p><strong><em>标记清除算法：</em></strong></p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-28_170911.png" alt></p>
<ul>
<li><p>优点：不需要额外的空间！</p>
</li>
<li><p>缺点：两次扫描，严重浪费时间，会产生内存碎片。</p>
</li>
</ul>
<p><strong><em>标记清除压缩算法：</em></strong></p>
<p>先标记清除几次，再压缩！he</p>
<p>再优化：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-28_171242.png" alt></p>
</li>
<li><p>总结</p>
</li>
</ol>
<p>内存效率：复制算法&gt;标记清除算法&gt;标记压缩算法（时间复杂度）</p>
<p>内存整齐度：复制算法=标记压缩&gt;标记清除算法</p>
<p>内存利用率：标记压缩算法=标记清除算法&gt;复制算法</p>
<p>思考：难道没有最优的算法吗？</p>
<p>答案：没有，没有最好的算法，只有最合适的算法！—-&gt;GC：分代收集算法</p>
<p>年轻代：</p>
<ul>
<li>存活率低</li>
<li>复制算法！</li>
</ul>
<p>老年代：</p>
<ul>
<li>区域大：存活率高</li>
<li>标记清除（内存碎片不是太多）+标记压缩混合 实现</li>
</ul>
<p>一天时间学JVM，不现实，要深究，必须要下去花时间，和多看面试题，以及《深入理解Java虚拟机》</p>
<p>但是，我们可以掌握一个学习JVM的方法。</p>
<p>18、JMM：Java Memory Model</p>
<ol>
<li><p>什么是JMM？</p>
</li>
<li><p>它干嘛的？：官方，其他人的博客，对应的视频！ </p>
<p>作用：缓存一致性协议，用于定义数据读写的规则（遵守，找到这个规则 ）</p>
<p>JMM定义了线程工作和主内存之间的抽象关系：线程之间的共享变量存储在主内存（Main Memory）中，每个线程都有一个私有的本地内存（Local Memory）</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-28_185803.png" alt></p>
<p>解决共享对象可见性问题：volidate</p>
</li>
<li><p>它如何学习？</p>
<p>JMM：抽象概念，理论</p>
<p>volidate ：</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-29_171421.png" alt></p>
</li>
<li><p>百度</p>
</li>
<li><p>思维导图</p>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
    
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://wyqian.top/2021/03/25/%E5%A6%82%E4%BD%95%E5%88%86%E6%9E%90%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/%E5%A6%82%E4%BD%95%E5%88%86%E6%9E%90%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="精进的coder">
      <meta itemprop="description" content="Do not talk, show me your code!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SC&KD's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/25/%E5%A6%82%E4%BD%95%E5%88%86%E6%9E%90%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/%E5%A6%82%E4%BD%95%E5%88%86%E6%9E%90%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/" class="post-title-link" itemprop="url">如何分析开源项目</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-03-25 09:10:00" itemprop="dateCreated datePublished" datetime="2021-03-25T09:10:00+08:00">2021-03-25</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/03/25/%E5%A6%82%E4%BD%95%E5%88%86%E6%9E%90%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/%E5%A6%82%E4%BD%95%E5%88%86%E6%9E%90%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/03/25/%E5%A6%82%E4%BD%95%E5%88%86%E6%9E%90%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/%E5%A6%82%E4%BD%95%E5%88%86%E6%9E%90%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <a id="more"></a>

<p> 学习的方式</p>
<ol>
<li>不知道这个代码怎么来的</li>
<li>这个代码跑不起来</li>
<li>这个项目对我们有什么帮助，不会模块化分析</li>
</ol>
<p>任何一个开源项目，都可以让自己得到提升！</p>
<p>下面以一个案例来说明如何分析开源项目：</p>
<p><a href="https://gitee.com/elunez/eladmin" target="_blank" rel="noopener">https://gitee.com/elunez/eladmin</a></p>
<p><a href="https://gitee.com/elunez/eladmin-web" target="_blank" rel="noopener">https://gitee.com/elunez/eladmin-web</a></p>
<h2 id="观察开源项目"><a href="#观察开源项目" class="headerlink" title="观察开源项目"></a>观察开源项目</h2><p>后端的</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_093314.png" alt></p>
<p>前端的</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_094706.png" alt></p>
<h2 id="开源项目下载"><a href="#开源项目下载" class="headerlink" title="开源项目下载"></a>开源项目下载</h2><p>下载完毕，然后解压，优先使用码云下载！</p>
<p>解压，先不要着急运行！</p>
<p><strong><em>观察</em></strong></p>
<ol>
<li>用了哪些技术（Springboot,Vue,Redis,MQ…）</li>
<li>是否有数据库(MySQL)</li>
<li>你的环境是否匹配（java, Maven, npm, nodejs, redis）</li>
</ol>
<p>通过了，然后想办法运行！</p>
<h2 id="跑起来是第一步"><a href="#跑起来是第一步" class="headerlink" title="跑起来是第一步"></a>跑起来是第一步</h2><ol>
<li>安装数据库，执行sql</li>
<li>前端需要跑起来</li>
<li>后端项目<strong><em>导入</em></strong>跑起来</li>
<li>等待所有的项目跑成功！</li>
</ol>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_122739.jpg" alt></p>
<p>只要发现了Swagger，那么跑起来的第一步就是先进入Swagger-ui页面，因为这里面都是接口！</p>
<p>进而查看配置文件！默认端口，有哪些配置，需要改为自己的项目和环境地址！</p>
<p>前端就是安装依赖，启动测试运行，看接口是否正常！</p>
<h2 id="前后端分离项目固定套路"><a href="#前后端分离项目固定套路" class="headerlink" title="前后端分离项目固定套路"></a>前后端分离项目固定套路</h2><ol>
<li><p>从前端开始分析，打开控制台，点一个接口，分析一波调用关系！</p>
</li>
<li><p>前后端端口调用不一致！8013（前端）–8000（后端），怎么操作的</p>
<ul>
<li><p>封装了接口请求  ajax   axios  request</p>
</li>
<li><p>找到配置</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_131534.png" alt></p>
</li>
<li><p>前后端分离项目的重点：找到接口的调用关系</p>
</li>
<li><p>Springboot提供服务！前端调用接口数据！Vue负责渲染页面</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_131758.png" alt></p>
</li>
<li><p>前端项目固定套路</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_132113.png" alt></p>
</li>
<li><p>通过抓取前端的请求，找到后端对应的接口</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_133536.png" alt></p>
</li>
<li><p>后端分析</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_133926.png" alt></p>
</li>
<li><p>Controller–Service–Dao：你就能看懂了</p>
</li>
<li><p>现在从前到后可以分析了！但是如何渲染到视图上呢？看前端</p>
<p><img src="https://gitee.com/Curryforthreeeeee30/HexoPicture/raw/master/PicturteBed/2021-03-25_134502.png" alt></p>
</li>
<li><p>vue标准套路</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  视图层</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    js操作，接口的调用</span><br><span class="line">export default &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">页面的样式</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果你现在自己的项目或者你要学习一个模块，将这个模块独立抽取出来即可！删除法</p>
</li>
</ul>
</li>
</ol>
<h2 id="如何找到一个好的开源项目"><a href="#如何找到一个好的开源项目" class="headerlink" title="如何找到一个好的开源项目"></a>如何找到一个好的开源项目</h2><p>用码云做案例：</p>
<ol>
<li>找分类  JAVA</li>
<li>看收藏，开源项目，所有人都觉得不错的，那就是好的！</li>
<li>看具有价值</li>
<li>根据自身的理解情况去看，Java、SSM、Springboot、阶段性成果！</li>
<li>如何学习java</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
    
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://wyqian.top/2021/01/12/SpringMVC/SpringMVC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="精进的coder">
      <meta itemprop="description" content="Do not talk, show me your code!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SC&KD's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/12/SpringMVC/SpringMVC/" class="post-title-link" itemprop="url">SpringMVC</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-12 09:05:41" itemprop="dateCreated datePublished" datetime="2021-01-12T09:05:41+08:00">2021-01-12</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/01/12/SpringMVC/SpringMVC/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/01/12/SpringMVC/SpringMVC/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>81k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1:14</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="SpringMVC"><a href="#SpringMVC" class="headerlink" title="SpringMVC"></a>SpringMVC</h1>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/01/12/SpringMVC/SpringMVC/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
    
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://wyqian.top/2021/01/05/Spring/Spring/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="精进的coder">
      <meta itemprop="description" content="Do not talk, show me your code!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SC&KD's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/05/Spring/Spring/" class="post-title-link" itemprop="url">Spring</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-05 19:34:37" itemprop="dateCreated datePublished" datetime="2021-01-05T19:34:37+08:00">2021-01-05</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/01/05/Spring/Spring/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/01/05/Spring/Spring/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>43k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>39 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h1>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/01/05/Spring/Spring/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
    
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://wyqian.top/2020/12/25/MyBatis/MyBatis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="精进的coder">
      <meta itemprop="description" content="Do not talk, show me your code!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SC&KD's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/25/MyBatis/MyBatis/" class="post-title-link" itemprop="url">MyBatis</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-25 14:33:58" itemprop="dateCreated datePublished" datetime="2020-12-25T14:33:58+08:00">2020-12-25</time>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/12/25/MyBatis/MyBatis/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/12/25/MyBatis/MyBatis/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>33k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>30 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Mybatis-9-28"><a href="#Mybatis-9-28" class="headerlink" title="Mybatis-9.28"></a>Mybatis-9.28</h2>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/12/25/MyBatis/MyBatis/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
    
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="精进的coder"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">精进的coder</p>
  <div class="site-description" itemprop="description">Do not talk, show me your code!</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">60</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Curryforthreeeeee30" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Curryforthreeeeee30" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:wanyun_qian@163.com" title="E-Mail → mailto:wanyun_qian@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/wanyun_qian" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;wanyun_qian" rel="noopener" target="_blank"><i class="fa fa-fighter-jet fa-fw"></i>CSDN</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/5262513822/profile?topnav=1&wvr=6&is_all=1" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;5262513822&#x2F;profile?topnav&#x3D;1&amp;wvr&#x3D;6&amp;is_all&#x3D;1" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



      </div>
      <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=110 src="//music.163.com/outchain/player?type=0&id=5291304129&auto=1&height=90"></iframe>
    </div>
    
    
    
  </aside>
  <div id="sidebar-dimmer"></div>
  


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">精进的coder</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">530k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">8:02</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>


    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>






        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,0' opacity='0.5' zIndex='-1' count='150' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'OFKgux9umN8mfj7KNEwCq3Uc-gzGzoHsz',
      appKey     : 'v6tDnJ3gDBdO0mYlQh4h23BM',
      placeholder: "ヾﾉ≧∀≦)o来啊，快活啊!",
      avatar     : 'monsterid',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

  <script type="text/javascript" src="/lib/zclip/clipboard.min.js"></script>	
<script type="text/javascript" src="/js/src/custom.js"></script>
<script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>


<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body>
</html>
